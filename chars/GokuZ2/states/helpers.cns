;==============================================================
; CNS File for Goku by Team Z2
; Helper States
;==============================================================

;===================================================
; TAUNT HELPER - BIG CLOUD
[Statedef 196]
type=A
physics=N
movetype=I
anim = 196
velset=0,0
sprpriority=3

[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 195
pos = 20,-131;-20,-131

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 3005, end]
type = changeanim
trigger1 = root,stateno != 195 && time<38 && anim!=19600
value = 19600

[State 3005, peeking snd]
type = PlaySnd
trigger1 = (anim = 196) && (time = 38)
trigger2 = (anim = 19600)
value = 195,3
volume = 355
persistent = 0

[State 1061, End]
type = destroyself
trigger1 = !animtime

;===================================================
; TAUNT HELPER - SMALL CLOUD LONG
[Statedef 197]
type=A
physics=N
movetype=I
anim = 197
velset=0,0
sprpriority=3


[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 195
pos = 5,-80;-5,-80

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 3005, end]
type = changeanim
trigger1 = root,stateno != 195 && time<54 && anim!=19700
trigger2 = time=54
value = 19700

[State 1061, End]
type = destroyself
trigger1 = anim=19700 && !animtime

;===================================================
; TAUNT HELPER - SMALL CLOUD SHORT
[Statedef 198]
type=A
physics=N
movetype=I
anim = 197
velset=0,0
sprpriority=3

[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 195
pos = 10,-95;-10,-95

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 3005, end]
type = changeanim
trigger1 = root,stateno != 195 && time<44 && anim!=19700
trigger2 = time=44
value = 19700

[State 1061, End]
type = destroyself
trigger1 = anim=19700 && !animtime






;======================================================================
; POWER CHARGE AURA
[Statedef 905]
type = A
movetype = I
physics = N
ctrl = 0
anim = 905
velset = 0,0
sprpriority = -1

[State 1902, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1902, BindToParent]
type = BindToParent
trigger1 = anim = 905
pos = -10,-2

[State 1902, Anim]
type = ChangeAnim
triggerall = anim = 905
trigger1 = root,stateno = 901
value = 906

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = anim = 905 && (Root,StateNo != 900)
trigger2 = anim = 906 && animtime = 0
trigger3 = Root,stateno = [5000,5090]

;======================================================================
; POWER CHARGE AURA WINPOSE 3
[Statedef 906]
type = A
movetype = I
physics = N
ctrl = 0
anim = 905
velset = 0,0
sprpriority = -1

[State 1902, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1902, BindToParent]
type = BindToParent
trigger1 = anim = 905
pos = -10,-2

[State 1902, Anim]
type = ChangeAnim
triggerall = anim = 905
trigger1 = Root,anim != 2770
value = 906

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = Anim=906 && !AnimTime

;======================================================================
; POWER CHARGE AURA SSJ
[Statedef 907]
type = A
movetype = I
physics = N
ctrl = 0
anim = 907
velset = 0,0
sprpriority = -3

[State 1902, AssertSpecial]
type = AngleDraw
trigger1 = root,anim=902
trigger2 = root,anim=90201
scale = 1.4,1.4

[State 1902, AssertSpecial]
type = SprPriority
trigger1 = root,stateno=2965
value = 9

[State 1902, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1902, BindToParent]
type = BindToRoot
trigger1 = (root,anim = 740) || (root,anim=2965)
pos = 5,0
[State 1902, BindToParent]
type = BindToRoot
trigger1 = (root,anim = 902) || (root,anim = 90201) || (root,anim = 2950)
pos = -18,-2
[State 1902, BindToParent]
type = BindToRoot
trigger1 = (root,anim != 902) && (root,anim != 90201) && (root,anim != 740) && (root,anim != 2950) && (root,anim != 2965)
pos = -10,-2

[State 1902, Remove];when going SSJ (movie 7)
type = DestroySelf
trigger1 = root,stateno=2950 && time>=50

[State 1902, Remove];when dashing (movie 7)
type = DestroySelf
trigger1 = root,anim=2958

[State 1902, Remove];when winning (movie 7)
type = DestroySelf
trigger1 = root,stateno=0



;======================================================================
; DUST Helper (normal aura charge)
[Statedef 908]
type	= A
MoveType	= I
physics	= N
ctrl	= 0
anim	= 908+(Root, Var(2)=0)
velset	= 0,0
sprpriority = 4
[State 909, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
pos = -17,5

[State 908, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 908, NoShadow]
type	= Trans
trigger1	= Root, Var(2)=0
trans	= none
ignorehitpause = 1

[State 908, DestroySelf]
type	= DestroySelf
trigger1	= (Root,StateNo != 900)
trigger2	= Root,stateno = [5000,5090]




;======================================================================
; Light Ki blast : 1010
; Medium Ki blast : 1011
; Strong Ki blast : 1012
; Ki blast Vanishes : 1013
;======================================================================

;LIGHT KI BLAST HELPER
[Statedef 1010]
type    = S
movetype= A
physics = N
anim = 1010
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 2
ignorehitpause = 1

[State 1061, gethit gut ?]
type = VarSet
trigger1 = !time
var(14) = root,var(14)

[State 0, ParentVarAdd]
type = ParentVarAdd
trigger1 = MoveHit = 1
fvar(39) = 1
ignorehitpause = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 4

[State 1061, Velocity]
type = VelSet
trigger1 = Movehit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 1013
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = var(14)=0
attr = S, SP
animtype  = hard
;ceil(23*root,fvar(15)), ceil(3*root,fvar(15))
damage    = ceil(IfElse(root,fvar(11)*23<7,7, root,fvar(11)*23)),ceil(3*root,fvar(11))
priority  = 4,Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -3.8,0
guard.velocity = -3.5
air.velocity = -3.8,-2
airguard.velocity = -3, -2
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
fall = Cond(root,fVar(39)>=5,1,0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = ifelse(p2movetype=H,40,140), 10
givepower = 35,35

[State 1061, Hitdef]
type = HitDef
trigger1 = var(14)=1
attr = S, SP
animtype  = hard
;ceil(23*root,fvar(15)), ceil(3*root,fvar(15))
damage    = ceil(IfElse(root,fvar(11)*23<7,7, root,fvar(11)*23)),ceil(3*root,fvar(11))
priority  = 4,Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = low
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -3.8,0
guard.velocity = -3.5
air.velocity = -3.8,-2
airguard.velocity = -3, -2
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = ifelse(p2movetype=H,40,140), 10
givepower = 35,35

[State 3001, Guardshake]
type = envshake
trigger1 = moveguarded
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 1061, End]
type = destroyself
trigger1 = (pos x!=[-240,240])
trigger2 = time>180

[State 1061, Fade]
type = changestate
trigger1 = movecontact = 1
value = 1013
ignorehitpause = 1

;----------------------------------------------------
;MEDIUM KI BLAST HELPER
[Statedef 1011]
type    = S
movetype= A
physics = N
anim = 1010
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 2
ignorehitpause = 1

[State 1061, gethit gut ?]
type = VarSet
trigger1 = !time
var(14) = root,var(14)

[State 0, ParentVarAdd]
type = ParentVarAdd
trigger1 = MoveHit = 1
fvar(39) = 1
ignorehitpause = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 5.5

[State 1061, Velocity]
type = VelSet
trigger1 = Movehit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 1013
;attr = SCA, NP, SP, HP
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = var(14)=0
attr = S, SP
animtype  = hard
;ceil(26*root,fvar(15)), ceil(5*root,fvar(15))
damage    = ceil(Cond(root,fvar(11)*26 < 7, 7, root,fvar(11)*26)),ceil(5*root,fvar(11))
priority  = 4, Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7020
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -3.8,0
guard.velocity = -3.5
air.velocity = -3.8,-2
airguard.velocity = -3, -2
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
fall = Cond(root,fVar(39)>=5,1,0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= ifelse(p2movetype=H,40,140), 10
givepower = 35,35

[State 1061, Hitdef]
type = HitDef
trigger1 = var(14)=1
attr = S, SP
animtype  = hard
;ceil(26*root,fvar(15)), ceil(5*root,fvar(15))
damage    = ceil(Cond((root,fvar(11)*26)<7,7,(root,fvar(11)*26))),ceil(5*root,fvar(11))
priority  = 4, Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7020
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = low
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -3.8,0
guard.velocity = -3.5
air.velocity = -3.8,-2
airguard.velocity = -3, -2
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= ifelse(p2movetype=H,40,140), 10
givepower = 35,35

[State 3001, Guardshake]
type = envshake
trigger1 = moveguarded
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 1061, End]
type = destroyself
trigger1 = (pos x!=[-240,240])
trigger2 = time>180

[State 1061, Fade]
type = changestate
trigger1 = movecontact
value = 1013
ignorehitpause=1

;----------------------------------------------------
;STRONG KI BLAST HELPER
[Statedef 1012]
type    = S
movetype= A
physics = N
anim = 1010
sprpriority = 5
hitcountpersist = 1
movehitpersist = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 2
ignorehitpause = 1

[State 1061, gethit gut ?]
type = VarSet
trigger1 = !time
var(14) = root,var(14)

[State 0, ParentVarAdd]
type = ParentVarAdd
trigger1 = MoveHit = 1
fvar(39) = 1
ignorehitpause = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 7

[State 1061, Velocity]
type = VelSet
trigger1 = Movehit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 1013
;attr = SCA, NP, SP, HP
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = var(14)=0
attr = S, SP
animtype  = hard
;ceil(31*root,fvar(15)), ceil(7*root,fvar(15))
damage    = ceil(Cond((root,fvar(11)*31)<7,7,(root,fvar(11)*31))),ceil(7*root,fvar(11))
priority  = 4, Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7030
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -3.8,0
guard.velocity = -3.5
air.velocity = -3.8,-2
airguard.velocity = -3, -2
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
fall = Cond(root,fVar(39)>=5,1,0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= ifelse(p2movetype=H,40,140), 10
givepower = 35,35

[State 1061, Hitdef]
type = HitDef
trigger1 = var(14)=1
attr = S, SP
animtype  = hard
;ceil(31*root,fvar(15)), ceil(7*root,fvar(15))
damage    = ceil(Cond((root,fvar(11)*31)<7,7,(root,fvar(11)*31))),ceil(7*root,fvar(11))
priority  = 4, Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7030
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = low
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -3.8,0
guard.velocity = -3.5
air.velocity = -3.8,-2
airguard.velocity = -3, -2
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= ifelse(p2movetype=H,40,140), 10
givepower = 35,35

[State 3001, Guardshake]
type = envshake
trigger1 = moveguarded
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 1061, End]
type = destroyself
trigger1 = (pos x!=[-240,240])
trigger2 = time>180

[State 1061, Fade]
type = changestate
trigger1 = movecontact
value = 1013
ignorehitpause=1

;----------------------------------------------------
;KI BLAST HELPER VANISHES
[Statedef 1013]
type    = A
movetype= A
physics = N
anim = 1013
sprpriority = 5
velset = -2,0

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NoJuggle Safety]
type = parentvarset
trigger1 = !time
v = 18
value = 0

[State 1002, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, End]
type = destroyself
trigger1 = animtime = 0



;======================================================================
;LAND FX
[Statedef 17100]
type=A
movetype=I
physics=N
anim=15999
sprpriority=1
velset=0,0

[state 17100,bind]
type = bindtoparent
trigger1 = !time
pos = -11,0

[state 17100, Landing Effect]
type=explod
trigger1=!time
anim=17100
id=17100
pos=0,0
postype=P1
sprpriority=-3
ownpal=1
supermovetime=-1

[state 17100]
type=removeexplod
trigger1=time>10

[State 17100]
type=destroyself
trigger1=time>10


;======================================================================
; Repel helper : 1305
; Destroyed : 1306
; Reflect with random projectile : 1308
; Reflected projectile : 1315
; Reflected projectile explods : 1316
;======================================================================

; REPEL HELPER FOR SLASH CHOP
[Statedef 1305]
type = S
physics = N
movetype = A
ctrl = 0
sprpriority = 4

[State 1305, nothitby]
type = nothitby
trigger1 = 1
time = -1
value = SCA
ignorehitpause = 1

[State 1305, HB]
type = hitby
trigger1 = 1
time = 1
value = SCA, NP, SP, HP
ignorehitpause = 1

[State 1305, HitOverride]
type = hitoverride
trigger1 = 1
time = -1
attr = SCA, AA, AP, AT
stateno = 1306
ignorehitpause = 1

[State 1305, HitOverride]
type = hitoverride
trigger1 = 1
time = -1
attr = SCA, NP, SP,HP
stateno = 1308
ignorehitpause = 1

[State 1305, Anim]
type = changeanim
trigger1 = anim != 1305
value = 1305

[State 1305, timevar]
type = varadd
trigger1 = 1
var(4) = 1

[State 1305, Shadows]
type = afterimage
trigger1 = !time && !prevstateno
time = 999
timegap = 1
framegap = 4
length = 12
palcontrast = 30, 60, 120
trans = add

[State 1305, Type]
type = statetypeset
trigger1 = movecontact
movetype = I

[State 1305, End]
type = changestate
trigger1 = var(4) >= 13
value = 1306

;-----------------------------------------
; Destroyed
[Statedef 1306]
type = A
physics = N
movetype = I
velset = 0, 0
ctrl = 0
sprpriority = 1
anim = 15998

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 1306, End]
type = destroyself
trigger1 = !animtime

;-----------------------------------------
; Reflect with Goku Kameha projectile
[Statedef 1308]
type = A
physics = N
movetype = I
ctrl = 0
anim = 15998

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 1308, reflected]
type = helper
trigger1 = !time
helpertype = normal
stateno = 1315
ID = 1315
name = "Reflected"
postype = p1
pos = 25, -20
ownpal = 1
size.xscale = 1
size.yscale = 1

[State 1308, End]
type = changestate
trigger1 = 1
value = 1306   ;1305


;-----------------------------------------
; Reflected projectile Kamehameha
[Statedef 1315]
type=S
physics=N
movetype=A
ctrl=0
velset=0,0
sprpriority=4
poweradd = 150

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 200, Ki goes SFX]
type = PlaySnd
trigger1 = !time
value = 10,0
channel = 1

[State -2, Explod];P1 Side.
type = Explod
trigger1 = !time && numexplod(13300)=0 && teamside = 1
anim = 13300
pos = 10,80
postype = left  ;p2,front,back,left,right
removetime = -2
supermove = 1
;scale = 0.5,0.5
sprpriority = 0
id = 13300
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = -1
persistent = 0

[State -2, Explod];P2 Side.
type = Explod
trigger1 = !time && numexplod(13300)=0 && teamside = 2
anim = 13301
pos = -169,80
postype = right
removetime = -2
supermove = 1
;scale = 0.5,0.5
sprpriority = 0
id = 13300
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = -1
persistent = 0

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1315, HitOverride]
type=hitoverride
trigger1= 1
time=-1
attr=SCA,AA,AP,AT
stateno=1316
ignorehitpause=1

[State 1315, HB]
type=hitby
trigger1= 1
time=-1
value=SCA,NP,SP,HP
ignorehitpause=1

[state 1315]
type = varset
triggerall = numenemy
triggerall = enemy,authorname = "Balthazar & Cybaster"
trigger1 = enemy,name = "Goku Z2"
trigger2 = enemy,name = "SSJ Goku Z2"
trigger3 = enemy,name = "Vegeta Z2"
trigger4 = enemy,name = "Gohan Z2"
var(11) = 1

[State 1315, Anim];normal kamehameha FX (yellow/blue)
type=changeanim
trigger1= !time && !prevstateno && var(11)=0 && root,var(44)=0
value=1311
[State 1315, Anim];normal kamehameha FX (old purple)
type=changeanim
trigger1= !time && !prevstateno && var(11)=0 && root,var(44)>=1
value=1310
[State 1315, Anim];Goku kamehameha FX
type=changeanim
trigger1= !time && !prevstateno && var(11)=1
value=1010

[State 1315, Vel]
type=velset
trigger1= 1
x = 8

[State 1315, image]
type=afterimage
trigger1= !time && !prevstateno
time=999
timegap=1
framegap=2
length=5
palcontrast=50,50,200
trans=add

[State 1315, Hit]
type=hitdef
trigger1= 1
priority=4,Hit
attr = S,SP
;ceil(61*root,fvar(15)), ceil(6*root,fvar(15))
damage    = ceil(IfElse(root,fvar(11) * 61 < 7, 7, root,fvar(11) * 61)), ceil(6*root,fvar(11))
animtype = Hard
hitflag = MAF
guardflag=MA
pausetime=0,10
sparkno = -1
guard.sparkno = -1
sparkxy = -10,0
hitsound  = S1000,0
guardsound = S6,0
ground.type=High
ground.slidetime=16
ground.hittime=16
ground.velocity=-10,0
ground.cornerpush.veloff=0
air.velocity=-4,-2
getpower= ifelse(p2movetype=H,40,140), 35
givepower = 35,35
envshake.time=14
envshake.freq=120
envshake.ampl=4
air.fall=1
fall.recover=1
fall.recovertime=16
yaccel=.5
airguard.ctrltime= 16
airguard.velocity= -8, -1.5
forcestand=1
p1sprpriority = 5

[State 1315, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=7020
sprpriority=3
postype=p2
pos=(target,const(size.ground.front)-10),-floor(p2dist y)
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
persistent=0
pausemovetime=100
supermovetime=100

[State 1315, End]
type=changestate
trigger1= movecontact
value=1316
ignorehitpause=1

[State 1315, End]
type=destroyself
trigger1=pos x!=[-200,200]

;-----------------------------------------
; Kamehameha explod/vanish
[Statedef 1316]
type=A
physics=N
movetype=I
velset=0,0
ctrl=0
sprpriority=4

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 3005, anim];VS Goku
type = changeanim
trigger1 = !time && var(11)=1
value = 1013
[State 3005, anim];Repel (purple)
type = changeanim
trigger1 = !time && var(11)=0 && prevstateno=1315 && root,var(44)>=1
value = 1316
[State 3005, anim];Repel (yellow/blue)
type = changeanim
trigger1 = !time && var(11)=0 && prevstateno=1315 && root,var(44)=0
value = 1311

[State 3005, anim];Chou Kmh
type = changeanim
trigger1 = !time && prevstateno=2402
trigger2 = !time && prevstateno=2462
trigger3 = !time && prevstateno=3006
value = 15998
[State 3005, anim];Genkidama
type = changeanim
trigger1 = !time && (prevstateno=2511 || prevstateno=2521 || prevstateno=2523 || prevstateno=2531 || prevstateno=2533)
value = 2511
[State 3005, anim];Genkidama
type = changeanim
trigger1 = prevstateno=2533
trigger1 = anim=2511 && !animtime
value = 2532

[State 1061, scale Genkidama]
type = AngleDraw
trigger1 = anim=2511
scale = 0.5-0.005*time,0.5-0.005*time
ignorehitpause = 1

[State 3005, anim];Movie 7 hitter
type = changeanim
trigger1 = !time && prevstateno=2961
value = 15997

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1316, End]
type=destroyself
trigger1= !animtime
[State 1316, End with Zzyzzyxx fix]
type=null;destroyself
triggerall = !animtime
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = target, time <= 1 && !(target, hitshakeover)

;==========================================================
; KAMEHAMEHA HELPER
[Statedef 2001]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 1315

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2000,3

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<5,2001,2002)  ;1316)
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = ifelse((time<2 && var(2)>1),1,10)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ceil(35*root,fvar(15)), 4
damage    = ceil(IfElse(root,fvar(11) * 30 < 15, 15, root,fvar(11) * 30)), 4
getpower = 0,0
givepower = 35,35
pausetime = 3*(var(2)<5),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<5, 0, -6), ifelse(var(2)<5, 0, -4)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=5)
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
ID=2001

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<5,2001,2002)

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos x!=[-240,240]

;-----------------------------------------
; Kamehameha explod/vanish
[Statedef 2002]
type=A
physics=N
movetype=I
velset=0,0
ctrl=0
sprpriority=4
MoveHitPersist=1

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 3005, anim];Kmh horizontal
type = changeanim
trigger1 = !time
value = 1317

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1316, End]
type=destroyself
trigger1= !animtime
[State 1316, End with Zzyzzyxx fix]
type= null;destroyself
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = target, time <= 1 && !(target, hitshakeover)

;==========================================================
; KAMEHAMEHA HELPER - UPWARDS
[Statedef 2101]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 3005, trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 200, 128
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2101

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2000,3

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<5,2101,2102)
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = ifelse((time<2 && var(2)>1),1,8)
y = ifelse((time<2 && var(2)>1),-1,-6)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ceil(35*root,fvar(15)), 4
damage    = ceil(IfElse(root,fvar(11) * 30 < 15, 15, root,fvar(11) * 30)), 4
getpower = 0,0
givepower = 35,35
pausetime = 3*(var(2)<5),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<5, -1, -6), ifelse(var(2)<5, -3, -8)
guard.velocity = -8
air.velocity = -5.5,-6.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=5)
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
ID=2001

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<5,2101,2102)

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos x!=[-240,240]

;-----------------------------------------
; Kamehameha explod/vanish
[Statedef 2102]
type=A
physics=N
movetype=I
velset=0,0
ctrl=0
sprpriority=4
MoveHitPersist=1

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 3005, anim];Kmh horizontal
type = changeanim
trigger1 = !time
value = 2102

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1316, End]
type=destroyself
trigger1= !animtime
[State 1316, End with Zzyzzyxx fix]
type= null;destroyself
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = target, time <= 1 && !(target, hitshakeover)

;==========================================================
; KAMEHAMEHA HELPER - DOWNWARDS
[Statedef 2201]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 3005, trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 200, 128
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2201

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2000,3

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<5,2201,2202)
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 3055, vel]
type=velset
trigger1= 1
x = ifelse((time<2 && var(2)>1),1,8)
y = ifelse((time<2 && var(2)>1),1,6)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = A,HP
hitflag = MAFD
guardflag = MA
priority = 7,Hit
;ceil(35*root,fvar(15)), 4
damage    = ceil(IfElse(root,fvar(11) * 30 < 15, 15, root,fvar(11) * 30)), 4
getpower = 0,0
givepower = 35,35
pausetime = 3*(var(2)<5),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = Low
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<5, -1, -6), ifelse(var(2)<5, -3, -6)
guard.velocity = -8
air.velocity = -5,6
airguard.velocity = -4, 2.5 
down.velocity = 0,0
down.hittime = 20
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=5)
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
ID=2001

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<5,2201,2202)

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[state 17100, Hit Ground Effect]
type=explod
trigger1=pos y>=-20
anim=17100
id=17100
pos=20,20
postype=P1
sprpriority=-3
ownpal=1
supermovetime=-1
removetime = -2
persistent = 0

[state 17100, Wave Effect]
type=explod
trigger1=pos y>=-20
anim=2205+(root,var(2)=1)
id=2205
pos=25,30
postype=P1
sprpriority=7
ownpal=1
supermovetime=-1
removetime = -2
persistent = 0

[State 3055, end]
type = PlaySnd
trigger1 = pos y>=-30
value = s1000,0
persistent = 0

[State 3055, end]
type = changestate
trigger1 = pos y>=-30 && !movecontact
value = 2211
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos x!=[-240,240]

;-----------------------------------------
; Kamehameha explod/vanish
[Statedef 2202]
type=A
physics=N
movetype=I
velset=0,0
ctrl=0
sprpriority=4
MoveHitPersist=1

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 3005, anim];Kmh horizontal
type = changeanim
trigger1 = !time
value = 2202

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1316, End]
type=destroyself
trigger1= !animtime
[State 1316, End with Zzyzzyxx fix]
type= null;destroyself
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = target, time <= 1 && !(target, hitshakeover)

;==========================================================
; KAMEHAMEHA HELPER - DOWNWARDS, Hitting ground
[Statedef 2211]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
velset = 0,0

[State 3005, trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 200, 128
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time
value = 2211

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 1316
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = animelem=1 && !movehit
trigger2 = animelem=2 && !movehit
trigger3 = animelem=3 && !movehit
trigger4 = animelem=4 && !movehit
attr = A,HP
hitflag = MAFD
guardflag = HA
priority = 7,Hit
;ceil(35*root,fvar(15)), 4
damage    = ceil(IfElse(root,fvar(11) * 25 < 7, 7, root,fvar(11) * 25)), 4
getpower = 0,0
givepower = 35,35
pausetime = 3,6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = Low
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -6, -7
guard.velocity = -8
air.velocity = -4,-9
airguard.velocity = -4, -1.5 
down.velocity = 0,0
down.hittime = 20
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[state 17100, Hit Ground Effect]
type=explod
trigger1 = time = 10
trigger2 = time = 20
anim=17100
id=17100
pos=10,30
postype=P1
sprpriority=-3
ownpal=1
supermovetime=-1
removetime = -2

[state 17100, Wave Effect]
type=explod
trigger1 = time = 10
trigger2 = time = 20
anim=2205+(root,var(2)=1)
id=2205
pos=15,40
postype=P1
sprpriority=7
ownpal=1
supermovetime=-1
removetime = -2

[State 3055, end]
type = PlaySnd
trigger1 = time = 5
trigger2 = time = 10
trigger3 = time = 15
trigger4 = time = 20
value = s1000,0

[State 3055, end]
type = changestate
trigger1 = !animtime
value = 1316
ignorehitpause = 1


;==========================================================
; SUPER BG - Street Fighter 3
[Statedef 19875]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 10500, snd]
type = playsnd
trigger1 = !time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = time <= 55
flag = noFG

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic

[State 10000, Explod]; White BG
type = Explod
trigger1 = time = 0
anim = 19877
id = 19875
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = 99999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
supermove = 1
scale = 1.20,1.20
ignorehitpause = 1
persistent = 0

[State 10000, Explod SF3]
type = Explod
trigger1 = time = 0
anim = 19875
id = 10000
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
supermove = 1
scale = 1.20*0.9,1.20*1.05
ignorehitpause = 1
persistent = 0

[State 10000, pause]
type = Pause
trigger1 = Time = 0
time = 40
movetime = 40

[State 10000, RemoveExplod]
type = RemoveExplod
trigger1 = time = 44
id = 10000

[State 10000, RemoveExplod]
type = RemoveExplod
trigger1 = time = 55
id = 10500

[State 8020, End]
type = destroyself
trigger1 = !(roundstate>2)
trigger2 = time=1000

;==========================================================
; SUPER BG - Super DBZ (Physics)
[Statedef 19885]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4) && time<150
time=4
freq=80
ampl=7

[State 10500, snd]
type = playsnd
trigger1 = !time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = nokoslow
ignorehitpause = 1

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobardisplay
ignorehitpause = 1

[State 10000, Explod]; White BG
type = Explod
trigger1 = time = 0
anim = 19884
id = 19884
pos =  160,120
postype = left
sprpriority = -4
facing = 1
bindtime = -1
ownpal = 1
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.20,1.20
ignorehitpause = 1
persistent = 0
removetime = -2

[State 10000, Explod Krak]
type = Explod
trigger1 = time = 0
anim = 19885
id = 19885
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
supermove = 1
scale = 1,1
ignorehitpause = 1
persistent = 0

[State 10000, Scale Explod]
type = ModifyExplod
trigger1 = time>6
scale = 1+.01*time, 1+.01*time
id = 19885

[State 10000, RemoveExplod Krak]
type = RemoveExplod
trigger1 = time = 44
id = 19885

[State 10000, Explod Space BG]
type = Explod
trigger1 = time = 23
anim = 19886
id = 19886
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.3,1.3
ignorehitpause = 1
persistent = 0

[State 10000, Explod planet left]
type = Explod
trigger1 = time = 23
anim = 19887
id = 19886
pos =  0,240
postype = left
sprpriority = -6
facing = 1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.2,1.2
ignorehitpause = 1
persistent = 0
;vel = -.2,0
bindtime = -1

[State 10000, Explod planet right]
type = Explod
trigger1 = time = 23
anim = 19888
id = 19886
pos =  320,240
postype = left
sprpriority = -6
facing = 1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
scale = 1.2,1.2
ignorehitpause = 1
persistent = 0
;vel = .2,0
bindtime = -1

[State 1000, Helper]
type = Helper
trigger1 = time>=23 && time<70 && !(time%5) && numhelper(19890)<80 && numhelper(19891)<80
helpertype = Normal
name = "rocks"
id = 19890
pos = 160,20
postype = left
facing = 1
stateno = 19890
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 13300, black screen fade]
type = Explod
trigger1 = Time = 60
anim = 19883   ;2771
ID = 2771
postype = left
pos = 0,-50
bindtime = -1
removetime = 91
pausemovetime = 91
ontop = 1
scale = 2,3

[State 10000, RemoveExplod Krak]
type = RemoveExplod
trigger1 = time = 150
id = 19886

[State 8020, End]
type = destroyself
trigger1 = !(roundstate>2)
trigger2 = time=150

;------------------------------------------------------
;Rocks going up
[Statedef 19890]
type = A
movetype = I
physics = N
anim = 15999

[State 1003, Helper]
type = Helper
trigger1 = !time
helpertype = Normal
name = "rocks"
id = 19891
pos = ((random%320)),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, Helper]
type = Helper
trigger1 = !time
helpertype = Normal
name = "rocks"
id = 19891
pos = ((random%320)+320),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, Helper]
type = Helper
trigger1 = !time
helpertype = Normal
name = "rocks"
id = 19891
pos = ((random%320)-320),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = time=2

;-----------------
[Statedef 19891]
type = A
movetype = I
physics = N
anim = 19890 + random%6
sprpriority = -5

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 1004, vel]
type = velset
trigger1 = !time
y = -3-random%7

[State 1004, vel]
type = varset
trigger1 = !time
var(10) = random%2

[State 1004, assert]
type = angledraw
trigger1 = 1
value = ifelse(var(10)=0,5*time,-5*time)

[State 1004, DestroySelf]
type = DestroySelf
trigger1 = time > 300
trigger2 = pos Y < -340
trigger3 = root,stateno = 180

;==========================================================
; SUPER BG - Super DBZ (Ki attacks)
[Statedef 19892]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 3001, screen]
type = PosSet
trigger1 = !time
x = 0
y = -ceil(screenpos Y)
ignorehitpause = 1

[State 3001, screen]
type = PosSet
trigger1 = 1
x = 0
ignorehitpause = 1

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4) && time<150
time=4
freq=80
ampl=7

[State 10500, snd]
type = playsnd
trigger1 = !time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = nokoslow
ignorehitpause = 1

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobardisplay
ignorehitpause = 1

[State 10000, Explod]; White BG
type = Explod
trigger1 = !time
anim = 957
id = 11111
pos =  0,-30
postype = left
sprpriority = -7
facing = 1
bindtime = -1
ownpal = 1
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1
scale = 2,2

[State 10000, Explod Zwang]
type = Explod
trigger1 = time = 0
anim = 19896
id = 19896
pos =  160,120
postype = left
sprpriority = -5
facing = 1
bindtime = -1
ownpal = 1
removetime = 9999999999999
pausemovetime = 99999999999999
supermovetime = 99999999999999
ignorehitpause = 1
scale = .9,1.2

[State 10000, Scale Explod]
type = ModifyExplod
trigger1 = time>50
scale = .9+.005*(time-50), 1.2+.005*(time-50)
id = 19896

[State 1003, Helper]
type = Helper
trigger1 = !time
helpertype = Normal
name = "yellow_BG"
id = 19897
pos = 0,0
postype = left
facing = 1
stateno = 19897
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
persistent = 0

[State 13300, white screen fade]
type = Explod
trigger1 = Time = 60
anim = 19883
ID = 2771
postype = left
pos = 0,-50
bindtime = -1
removetime = 91
pausemovetime = 91
ontop = 1
scale = 2,3
ignorehitpause = 1

[State 10000, RemoveExplod zwang]
type = RemoveExplod
trigger1 = time = 140
id = 19896
[State 10000, RemoveExplod yellow BG]
type = RemoveExplod
trigger1 = time = 140
id = 19897
[State 10000, RemoveExplod white BG]
type = RemoveExplod
trigger1 = time = 140
id = 11111

[State 10000, pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20
ignorehitpause = 1

;[State 10000, pause]
;type = Pause
;trigger1 = time>20 && time<100 && !(time%3)
;time = 1
;movetime = 1
;ignorehitpause = 1

[State 8020, End]
type = destroyself
trigger1 = !(roundstate>2)
trigger2 = time=150

;--------------------------------------
;Yellow Super BG Helper
[Statedef 19897]
type = S
movetype = I
physics = N
anim = 19897
sprpriority = -6

[State 1004, assert]
type = bindtoparent
trigger1 = 1
pos = 0,120
ignorehitpause = 1

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = noshadow
flag2 = noFG
ignorehitpause = 1

[State 1004, assert]
type = angledraw
trigger1 = time < 50
value = 10*time
scale = .7,.7
ignorehitpause = 1

[State 1004, assert]
type = angledraw
trigger1 = time >= 50
value = 10*time
scale = .7+.01*(time-50),.7+.01*(time-50)
ignorehitpause = 1

[State 1004, DestroySelf]
type = DestroySelf
trigger1 = time > 130

;==========================================================
; SUPER BG - Jojo's Bizarre Adventure
[Statedef 19900]
type    = A
movetype= I
physics = N
ctrl = 0
anim = 15999
sprpriority = -21

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19910
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindtime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19911
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindtime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19912
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindtime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19913
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindtime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19900
id = 19900
pos = 0,0
postype = back
sprpriority = 5
bindtime = -1
scale = .84, 1.07
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1
persistent = 0
ontop = 1

[State 10500, snd]
type = playsnd
trigger1 = !time
value = 9,0

[state haha]
type = varset
trigger1 = time = 0
var(3) = 0

[state haha]
type = varadd
trigger1 = time >= 5
trigger1 = var(3) < 220
var(3) = 5

[State that starts the inverted effect]
type           = PalFX
trigger1       = time >= 5
add            = var(3),var(3),var(3)
time           = 1
ignorehitpause = 1

[State 2030, 0]
type = AssertSpecial
Trigger1 = Time < ifelse(matchover, 120, 50)
flag = nofg
flag2 = nobardisplay
ignorehitpause = 1

[State haha]
type = RemoveExplod
trigger1 = Time = ifelse(matchover, 120, 50)
id = 8001

[State ChangeState!]
type = DestroySelf
trigger1 = RoundState = 0

;==========================================================
;BICYCLE KICK TRAINEE 
[StateDef 2303] ; AftImg
type = S
movetype = I
physics = N
ctrl = 0
anim = 2302

[State 13001, Pos]
type = BindToRoot
trigger1 = time = 0
time = -1
facing = 1

[State 13001, NoVis]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 13001, NoHit]
type = NotHitBy
trigger1 = 1
value = SCA

[State 13001, Aftimg]
type = AfterImage
trigger1 = Time = 0
time = 900
PalContrast = 255,255,255
PalBright = -120,-80,-50
TimeGap = 2
PalColor = 0
trans = add1

[State 13001, EndImg]
type = AfterImageTime
trigger1 = (Root, Stateno != 2302) && (Root, Stateno != 2602) && (Root, Stateno != 2652) && (Root, Stateno != 2654)
trigger2 = root,anim=2302 && root,animelemtime(12)>=0
time = 1

[State 13001, End]
type = DestroySelf
trigger1 = (Root, StateNo != [2300,2302]) && (Root, StateNo != [2600,2602]) && (Root, StateNo != [2650,2655])
trigger2 = root,anim=2302 && root,animelemtime(12)=0

;===================================================
;DASH COLLISION NOTIFICATION
[Statedef 13200]
type=A
physics=N
movetype=I
anim = 15999
velset=0,0
sprpriority=6

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

;[State -2, Explod]; Notification
;type = Explod
;trigger1 = !time
;anim = 13200
;removetime = -2
;supermove = 1
;sprpriority = 1
;id = 13200
;bindtime = -1
;ontop = 1
;ownpal = 1
;ignorehitpause = 1
;pausemovetime = -1
;facing = facing
;scale = 0.5,0.5
;
;[state 17100,scale FX]
;type = modifyexplod
;trigger1 = numexplod(13200)
;trigger1 = time>=10
;scale = 0.5+0.02*(time-10),0.5+0.02*(time-10)
;id = 13200

[State 8000, End]
type=destroyself
trigger1= time>=40

;===================================================
;BEAM COLLISION NOTIFICATION
[Statedef 13250]
type=A
physics=N
movetype=I
anim = 15999
velset=0,0
sprpriority=6

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State -2, Explod]; Notification
type = Explod
trigger1 = !time
anim = 13250
removetime = -2
supermove = 1
sprpriority = 1
id = 13250
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = -1
pos = 160,120
postype = left
scale = 0.5,0.5

[state 17100,scale FX]
type = modifyexplod
trigger1 = numexplod(13250)
trigger1 = time>=10
scale = 0.5+0.02*(time-10),0.5+0.02*(time-10)
id = 13250

[State 8000, End]
type=destroyself
trigger1= time>=40

;===================================================
; CHOU KAME Straight
[Statedef 2402]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = .85
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State -2, Explod];var for scaling CLSNs
type = VarSet
trigger1 = !prevstateno && !time
var(1) = 0
[State -2, Explod];var for scaling CLSNs
type = VarAdd
trigger1 = !prevstateno
var(1) = 1

[State 2011, NotHitBy]
type		= NotHitBy
trigger1		= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2011, HitBy]
type		= HitBy
trigger1		= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2011, HitOverride]
type		= HitOverride
trigger1		= Time >= 0
slot		= 1
Time		= 1
stateno		= 2402
attr		= SCA, NP, SP, HP
ignorehitpause	= 1

[State -2, Explod];Tip of Kmh FX
type = Explod
trigger1 = !numexplod(2404) && !time
anim = 2404
removetime = -1
sprpriority = 5
id = 2404
ownpal = 1
pos = 10,0
ignorehitpause = 1
pausemovetime = 99999
supermovetime = 99999
bindtime = -1
scale = 1,1+.3*(root,stateno = 3015)

[State -2, Explod];On hands explod
type = ModifyExplod
trigger1 = WinKO && MatchOver
scale = 1.5,1.5
ID = 2404

[State -2, Explod];Tip of Kmh FX
type = RemoveExplod
trigger1 = root,stateno != 2401
id = 2404

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(25) = root,var(25)

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno && !movecontact
value = 2405

[State 3005, anim]
type = changeanim
trigger1 = movecontact
value = 2405
elem = var(1)
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = ifelse((time<2 && var(2)>1),1,16)

[State 3005, hit]
type = hitdef
triggerall = var(25)<20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ifelse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=20,8,ifElse(root,fvar(11) * 23 < 11, 11, root,fvar(11) * 23))),2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<20+var(25), -2, -10), ifelse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 3005, hit]
type = hitdef
triggerall = var(25)>=20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = 
priority = 7,Hit
;ifelse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=20,8,ifElse(root,fvar(11) * 23 < 11, 11, root,fvar(11) * 23))),2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<20+var(25), -2, -10), ifelse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0


[State 3025, p2state - killed]
type = targetstate
triggerall = NumEnemy < 2
trigger1 = movehit && numtarget
trigger1 = MatchOver
trigger1 = WinKO
value = ifelse((target, SelfAnimExist(5941)), 5941, 5943)
ignorehitpause = 1

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<20+var(25),2402,1316)

[State 1061, End]
type = destroyself
trigger1 = root,stateno != 2401

;===================================================
; CHOU KAME Up
[Statedef 2462]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = .85
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 2011, NotHitBy]
type		= NotHitBy
trigger1		= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2011, HitBy]
type		= HitBy
trigger1		= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2011, HitOverride]
type		= HitOverride
trigger1		= Time >= 0
slot		= 1
Time		= 1
stateno		= 2462
attr		= SCA, NP, SP, HP
ignorehitpause	= 1

[State -2, Explod];var for scaling CLSNs
type = VarSet
trigger1 = !prevstateno && !time
var(1) = 0
[State -2, Explod];var for scaling CLSNs
type = VarAdd
trigger1 = !prevstateno
var(1) = 1

[State 3000, Kamehameha FX beam]
type = helper
trigger1 = !numhelper(2465) && !time
helpertype = normal
stateno = 2465
ID = 2465
name = "tip-chouKmh"
postype = p1
pos = 0,0
ownpal = 1

[State -2, Explod];Tip of Kmh FX
type = RemoveExplod
trigger1 = root,stateno != 2461
id = 2404

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(25) = root,var(25)

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno && !movecontact
value = 2465

[State 3005, anim]
type = changeanim
trigger1 = movecontact && animelemtime(30)<0
value = 2465
elem = var(1)
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = time<45
x = ifelse((time<2 && var(2)>1),1,10)
y = ifelse((time<2 && var(2)>1),-1,-7)

[State 1061, Velocity]
type = VelSet
trigger1 = time>=45
x = 0
y = 0

[State 3005, hit];Not MAX and not last hit
type = hitdef
triggerall = var(25)<20 && var(2)<20+var(25)
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ifelse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=20,8,ifElse(root,fvar(11)*23<11,11, root,fvar(11)*23))),2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -1,-1
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 3005, hit];Not MAX and LAST hit
type = hitdef
triggerall = var(25)<20 && var(2)=20+var(25)
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ifelse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=20,8,ifElse(root,fvar(11) * 23 < 11, 11, root,fvar(11) * 23))),2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -6,-8
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
;p2stateno = 2467
id = 2467

[State 3005, hit];MAX and not last hit
type = hitdef
triggerall = var(25)>=20 && var(2)<20+var(25)
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = 
priority = 7,Hit
;ifelse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=20,8,ifElse(root,fvar(11) * 23 < 11, 11, root,fvar(11) * 23))),2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -1,-1
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 3005, hit];MAX and LAST hit
type = hitdef
triggerall = var(25)>=20 && var(2)=20+var(25)
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = 
priority = 7,Hit
;ifelse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=20,8,ifElse(root,fvar(11) * 23 < 11, 11, root,fvar(11) * 23))),2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -6,-8
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
;p2stateno = 2467
id = 2467

[State 0, TargetState]  
type = TargetState
trigger1 = Numtarget(2467)
trigger1 = movehit = 1
value = 2467
ID = 2467
ignorehitpause = 1
persistent = 0

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 3025, p2state - killed]
type = targetstate
triggerall = NumEnemy < 2
trigger1 = movehit && numtarget
trigger1 = MatchOver
trigger1 = WinKO
value = 5944
ignorehitpause = 1

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<20+var(25),2462,1316)

[State 1061, End]
type = destroyself
trigger1 = root,stateno != 2461

;===================================================
; CHOU KAME UP FX HELPER - ON HANDS
[Statedef 2463]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 4
anim = 2403

[State 1061, End]
type = VarAdd
trigger1 = root,stateno = 2461
trigger2 = root,stateno = 3015
var(0) = 1
ignorehitpause = 1

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 2461
trigger2 = root,stateno = 3015
pos = 40,-81
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = !MatchOver
trigger1 = root,stateno = 2461
trigger2 = root,stateno = 3015
value = 35
scale = 1,1+.3*(root,stateno = 3015)
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = WinKO && MatchOver
trigger1 = root,stateno = 2461
trigger2 = root,stateno = 3015
value = 35
scale = 1,1.5+.1*(root,stateno = 3015)
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2466
trigger2 = root,stateno = 3020
scale = 1 , ifelse(1-0.05*(time-var(0))<0,0 , 1-0.05*(time-var(0)))
value = 35
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = root,stateno != 2461
trigger1 = root,stateno != 2466
trigger1 = root,stateno != 3015
trigger1 = root,stateno != 3020

;===================================================
; CHOU KAME FX HELPER - SCALED BEAM
[Statedef 2464]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 3
anim = 2464

[State 1061, End]
type = VarAdd
trigger1 = root,stateno = 2401
trigger2 = root,stateno = 2461
trigger3 = root,stateno = 3005
trigger4 = root,stateno = 3015
var(0) = 1
ignorehitpause = 1

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 2401
trigger2 = root,stateno = 2403
trigger3 = root,stateno = 3005
trigger4 = root,stateno = 3010
pos = 72,-58
ignorehitpause = 1
[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 2461
trigger2 = root,stateno = 3015
pos = 65,-98
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2401
trigger1 = !MatchOver
scale = (50.0 + abs(pos X - (helper(2402),pos X)))/58.0 , 1    ;60+...
value = 0
ignorehitpause = 1
[State 1061, End]
type = AngleDraw
trigger1 = !MatchOver
trigger1 = root,stateno = 2461
scale = (40.0 + abs(pos X - (helper(2462),pos X)))/60.0 , 1
value = 35
ignorehitpause = 1
[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 3005
trigger1 = !MatchOver
scale = (50.0 + abs(pos X - (helper(3006),pos X)))/58.0 , 1    ;60+...
value = 0
ignorehitpause = 1
[State 1061, End]
type = AngleDraw
trigger1 = !MatchOver
trigger1 = root,stateno = 3015
scale = (40.0 + abs(pos X - (helper(3016),pos X)))/60.0 , 1.3
value = 35
ignorehitpause = 1

;Scale Up when Killing the Opponent
[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2401
trigger1 = WinKO && MatchOver
scale = (70.0 + abs(pos X - (helper(2402),pos X)))/60.0 , 1.5
value = 0
ignorehitpause = 1
[State 1061, End]
type = AngleDraw
triggerall = WinKO && MatchOver
trigger1 = root,stateno = 2461
;scale = (55.0 + abs(pos X - (helper(2462),pos X)))/60.0 , 1.6
scale = 50,1.5
value = 35
ignorehitpause = 1
[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 3005
trigger1 = WinKO && MatchOver
scale = (70.0 + abs(pos X - (helper(3006),pos X)))/60.0 , 1.5
value = 0
ignorehitpause = 1
[State 1061, End]
type = AngleDraw
triggerall = WinKO && MatchOver
trigger1 = root,stateno = 3015
;scale = (55.0 + abs(pos X - (helper(3016),pos X)))/60.0 , 1.6
scale = 50,1.5
value = 35
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2403 || root,stateno = 3010
scale = 10 , ifelse(1-0.05*(time-var(0))<0, 0, 1-0.05*(time-var(0)))
value = 0
ignorehitpause = 1
[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2466 || root,stateno = 3020
scale = 10 , ifelse(1-0.05*(time-var(0))<0,0,1-0.05*(time-var(0)))
value = 35
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = root,stateno != 2461
trigger1 = root,stateno != 2466
trigger1 = root,stateno != 2401
trigger1 = root,stateno != 2403
trigger1 = root,stateno != 3005
trigger1 = root,stateno != 3010
trigger1 = root,stateno != 3015
trigger1 = root,stateno != 3020

;===================================================
; CHOU KAME UP FX HELPER - TIP OF BEAM
[Statedef 2465]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
anim = 2404

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 1061, End]
type = bindtoParent
trigger1 = root,stateno = 2461
trigger2 = root,stateno = 3015
pos = -32,-94
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = !MatchOver
trigger1 = root,stateno = 2461
trigger2 = root,stateno = 3015
value = 35
scale = 1,1+.3*(root,stateno = 3015)
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = WinKO && MatchOver
trigger1 = root,stateno = 2461
trigger2 = root,stateno = 3015
value = 35
scale = 1.5,1.5+.1*(root,stateno = 3015)
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = root,stateno != 2461
trigger1 = root,stateno != 3015
trigger2 = MatchOver


;===================================================
; Up Kaio CHOU KAME aura
[Statedef 2468]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
anim = 3005

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag = noshadow
ignorehitpause = 1

[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 3015
pos = 30,5
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = 1
trigger1 = root,stateno = 3015
value = 35
scale = 1,1
ignorehitpause = 1


[State 1061, End]
type = destroyself
trigger1 = root,stateno != 3015



;==========================================================
; GENKI- Weak
[Statedef 2511]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2511

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2500,4   ;2000,2

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<10,2511,1316)
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = ifelse((time<2 && var(2)>1),1,12)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;17, 3
damage    = ceil(IfElse(root,fvar(11) * 25 < 13, 13, root,fvar(11) * 17)), 3
getpower = 0,0
givepower = 35,35
pausetime = 3*(var(2)<10),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<10, 0, -6), ifelse(var(2)<10, 0, -4)
guard.velocity = -1
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=10)
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s ifelse(var(2)=10,2512,7020)
guard.sparkno = s ifelse(var(2)=10,2512,7000)
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

;[State 1315, Sparks]
;type=explod
;trigger1= movehit && numtarget
;trigger1= (target,movetype=H) && !(target,time)
;anim=ifelse(var(2)=10,2512,7020)
;sprpriority=7
;postype=p2
;pos=(target,const(size.ground.front)-10),-floor(p2dist y)
;removetime=-2
;ownpal=1
;facing=-1
;ignorehitpause=1
;persistent=0
;pausemovetime=100
;supermovetime=100
;
;[State 1315, Sparks]
;type=explod
;trigger1= moveguarded && numtarget && (var(2)=10)
;anim=2512
;sprpriority=7
;postype=p2
;pos=(target,const(size.ground.front)-10),-floor(p2dist y)
;removetime=-2
;ownpal=1
;facing=-1
;ignorehitpause=1
;persistent=0
;pausemovetime=100
;supermovetime=100

[State 13100, explosion SND]
type = playsnd
triggerall = movecontact=1 && numtarget
trigger1 =  movehit=1 && numenemy
value = 2511,0
volume = 355

[State 3005, end]
type = changestate
trigger1 = movecontact=1
value = ifelse(var(2)<10,2511,1316)

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos x!=[-240,240]

;==========================================================
; GENKI- Medium 1
[Statedef 2521]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 3000, width]
type=width
trigger1 = 1
edge = 100,0

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2523

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2500,4   ;2000,2

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<15,2521,1316)
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = ifelse((time<2 && var(2)>1),1,10)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;17, 3
damage    = ceil(IfElse(root,fvar(11) * 35 < 10, 10, root,fvar(11) * 17)), 7
getpower = 0,0
givepower = 35,35
pausetime = 3*(var(2)<10),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity = 0, ifelse(var(2)<10, 0, -12)
guard.velocity = -9
air.velocity = 0, ifelse(var(2)<10, 0, -12)
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=10)
air.fall = 1
fall.recover = 0
sparkno = s ifelse(var(2)=10,2512,7020)
guard.sparkno = s ifelse(var(2)=10,2512,7000)
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

;[State 1315, Sparks]
;type=explod
;trigger1= movehit && numtarget
;trigger1= (target,movetype=H) && !(target,time)
;anim=ifelse(var(2)=10,2512,7020)
;scale=ifelse(var(2)=10,1.25,1),ifelse(var(2)=10,1.25,1)
;sprpriority=7
;postype=p2
;pos=(target,const(size.ground.front)-10),-floor(p2dist y)
;removetime=-2
;ownpal=1
;facing=-1
;ignorehitpause=1
;persistent=0
;pausemovetime=100
;supermovetime=100
;
;[State 1315, Sparks];explosion when guarded
;type=explod
;trigger1= moveguarded && numtarget && (var(2)=10)
;anim=2512
;sprpriority=7
;postype=p2
;pos=(target,const(size.ground.front)-10),-floor(p2dist y)
;removetime=-2
;ownpal=1
;facing=-1
;ignorehitpause=1
;persistent=0
;pausemovetime=100
;supermovetime=100

[State 13100, explosion SND]
type = playsnd
triggerall = movecontact=1 && numtarget
trigger1 =  movehit=1 && numenemy
trigger1 = var(2) = 10
value = 2511,0
volume = 355

[State 3005, end]
type = changestate
trigger1 = movecontact=1
value = ifelse(var(2)<10,2521,ifelse(movehit,2522,1316))

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos x!=[-240,240]

;-------------------------------------
;GENKI- Medium- 
[Statedef 2522]; Medium version waits
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
velset = 0.85,0

[State 1061, not too close to edge]
type = Velset
trigger1 = FrontEdgeDist < 30
X = 0
Y = 0

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2523

[state 17100, Wave Effect]
type=explod
trigger1 = time = 25
anim=2205+(root,var(2)=1)
id=2205
pos=0,-floor(p2dist y)
postype=P1
sprpriority=7
ownpal=1
supermovetime=-1
removetime = -2

[state 17100, Wave Effect]
type=explod
trigger1 = time = 25
anim=2517
id=2205
pos=0,0
postype=P1
sprpriority=6
ownpal=1
supermovetime=-1
removetime = -2

[State 3005, end]
type = changestate
trigger1 = time > 25
value = 2523

;-------------------------------------
;GENKI- Medium 2
[Statedef 2523]; Medium version goes up
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
velset = 0,0

[State 3005, scale]
type = AngleDraw
trigger1 = var(2)<15
value = 0
scale = 0.9+0.1*(var(2)-10),0.9+0.1*(var(2)-10)
[State 3005, scale]
type = AngleDraw
trigger1 = var(2)=15
value = 0
scale = 1.5,1.5

[State 3005, anim]
type = changeanim
trigger1 = !time
value = 2523

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2500,4   ;2000,2

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<15,2523,1316)
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
y = ifelse((time<2 && var(2)>1),-4,-10)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;17, 3
damage    = ceil(IfElse(root,fvar(11) * 40 < 10, 10, root,fvar(11) * 17)), 13
getpower = 0,0
givepower = 35,35
pausetime = 7,0
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<15, ifelse(var(2)%2=0,2,-2), -2), ifelse(var(2)<15, -2, -7)
guard.velocity = -9
air.velocity =  ifelse(var(2)<15, ifelse(var(2)%2=0,3,-3), -2), ifelse(var(2)<15, -4, -7)
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=15)
air.fall = 1
fall.recover = 0
sparkno = s ifelse(var(2)=15,2512,7020)
guard.sparkno = s ifelse(var(2)=15,2512,7000)
hitsound   = s2400,3
guardsound = S6,0
p2facing = ifelse(var(2)%2=0,-1,1)
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[state 1215, Horizontal lightning]
type = explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim = ifelse(var(2)%2=0,2515,2516)
id = 2515
pos = (target,const(size.ground.front)-20),-floor(p2dist y)+(target,const(size.mid.pos.y))
postype = p2
sprpriority = 4
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
pausemovetime=100
supermovetime=100
scale = 0.6,0.6

;[State 1315, Sparks]
;type=explod
;trigger1= movehit && numtarget
;trigger1= (target,movetype=H) && !(target,time)
;anim=ifelse(var(2)=15,2512,7020)
;scale=ifelse(var(2)=15,1.25,1),ifelse(var(2)=15,1.25,1)
;sprpriority=7
;postype=p2
;pos=(target,const(size.ground.front)-10),-floor(p2dist y)-20*(var(2)=15)
;removetime=-2
;ownpal=1
;facing=-1
;ignorehitpause=1
;persistent=0
;pausemovetime=100
;supermovetime=100

[State 13100, explosion SND]
type = playsnd
triggerall = movecontact=1 && numtarget
trigger1 =  movehit=1 && numenemy
trigger1 = var(2) = 15
value = 2511,0
volume = 355

[State 3005, end]
type = changestate
trigger1 = movecontact=1
value = ifelse(var(2)<15,2523,1316)

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos y!=[-240,240]


;==========================================================
; GENKI- Strong 1
[Statedef 2531]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5


[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2523

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2500,4   ;2000,2

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<15,2531,1316)
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = ifelse((time<2 && var(2)>1),1,10)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;17, 3
damage    = ceil(IfElse(root,fvar(11) * 60 < 7, 7, root,fvar(11) * 17)), 13
getpower = 0,0
givepower = 35,35
pausetime = 3*(var(2)<10),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity = 0, ifelse(var(2)<10, 0, -12)
guard.velocity = -9
air.velocity = 0, ifelse(var(2)<10, 0, -12)
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=10)
air.fall = 1
fall.recover = 0
sparkno = s ifelse(var(2)=10,2512,7020)
guard.sparkno = s ifelse(var(2)=10,2512,7000)
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

;[State 1315, Sparks]
;type=explod
;trigger1= movehit && numtarget
;trigger1= (target,movetype=H) && !(target,time)
;anim=ifelse(var(2)=10,2512,7020)
;scale=ifelse(var(2)=10,1.3,1),ifelse(var(2)=10,1.3,1)   ;1.5 before
;sprpriority=7
;postype=p2
;pos=(target,const(size.ground.front)-10),-floor(p2dist y)
;removetime=-2
;ownpal=1
;facing=-1
;ignorehitpause=1
;persistent=0
;pausemovetime=100
;supermovetime=100

;[State 1315, Sparks];explosion when guarded
;type=explod
;trigger1= moveguarded && numtarget && (var(2)=10)
;anim=2512
;scale = 1.5,1.5
;sprpriority=7
;postype=p2
;pos=(target,const(size.ground.front)-10),-floor(p2dist y)
;removetime=-2
;ownpal=1
;facing=-1
;ignorehitpause=1
;persistent=0
;pausemovetime=100
;supermovetime=100

[State 13100, explosion SND]
type = playsnd
triggerall = movecontact=1 && numtarget
trigger1 =  movehit=1 && numenemy
trigger1 = var(2) = 10
value = 2511,0
volume = 355

[State 3005, end]
type = changestate
trigger1 = movecontact=1
value = ifelse(var(2)<10,2531,ifelse(movehit,2532,1316))

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos x!=[-240,240]

;-------------------------------------
;GENKI- Strong- 
[Statedef 2532]; Strong version waits
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
velset = 2,0

[State 1061, not too close to edge]
type = Velset
trigger1 = FrontEdgeDist < 30
X = 0
Y = 0

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2531

[state 17100, Wave Effect]
type=explod
trigger1 = time = 25
anim=2205+(root,var(2)=1)
id=2205
pos=0,-floor(p2dist y)
postype=P1
sprpriority=7
ownpal=1
supermovetime=-1
removetime = -2

[state 17100, Wave Effect]
type=explod
trigger1 = time = 25
anim=2517
id=2205
pos=0,0
postype=P1
sprpriority=6
ownpal=1
supermovetime=-1
removetime = -2

[State 3005, end]
type = changestate
trigger1 = time > 25
value = 2533

;-------------------------------------
; GENKI- Strong 2
[Statedef 2533]; Strong version goes up
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
velset = 0,0

[State 3005, scale]
type = AngleDraw
trigger1 = var(2)<20
value = 0
scale = 1.1+0.08*(var(2)-10),1.1+0.08*(var(2)-10)   ;.12 instead of .08
[State 3005, scale]
type = AngleDraw
trigger1 = var(2)=20
value = 0
scale = 2.,2.

[State 3005, anim]
type = changeanim
trigger1 = !time
value = 2531

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2500,4   ;2000,2

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<20,2533,1316)
attr = SCA, NP, SP, HP
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
y = ifelse((time<2 && var(2)>1),-4,-10)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;12, 2
damage    = ceil(IfElse(root,fvar(11) * 25 < 13, 13, root,fvar(11) * 17)), 13
getpower = 0,0
givepower = 35,35
pausetime = 7,0
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<20, ifelse(var(2)%2=0,4,-4), -2), ifelse(var(2)<20, -2, -7)
guard.velocity = -9
air.velocity =  ifelse(var(2)<20, ifelse(var(2)%2=0,4,-4), -2), ifelse(var(2)<20, -3, -7)
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20)
air.fall = 1
fall.recover = 0
sparkno = s ifelse(var(2)=20,2512,7020)
guard.sparkno = s ifelse(var(2)=20,2512,7000)
hitsound   = s2400,3
guardsound = S6,0
p2facing = ifelse(var(2)=20,1,ifelse(var(2)%2=0,-1,1))
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
ID = 2533

[state 1215, Horizontal lightning]
type = explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim = ifelse(var(2)%2=0,2515,2516)
id = 2515
pos = (target,const(size.ground.front)-20),-floor(p2dist y)+(target,const(size.mid.pos.y))
postype = p2
sprpriority = 4
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
pausemovetime=100
supermovetime=100
scale = 0.6,0.6

;[State 1315, Sparks]
;type=explod
;trigger1= movehit && numtarget
;trigger1= (target,movetype=H) && !(target,time)
;anim=ifelse(var(2)=20,2512,7020)
;scale=ifelse(var(2)=20,1.6,1),ifelse(var(2)=20,1.6,1)
;sprpriority=7
;postype=p2
;pos=(target,const(size.ground.front)-10),-floor(p2dist y)-20*(var(2)=20)
;removetime=-2
;ownpal=1
;facing=-1
;ignorehitpause=1
;persistent=0
;pausemovetime=100
;supermovetime=100

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = movehit && numtarget
time = 2
color = 0
invertall = 1
ignorehitpause = 1
persistent = 0

[State 13100, explosion SND]
type = playsnd
triggerall = movecontact=1 && numtarget
trigger1 =  movehit=1 && numenemy
trigger1 = var(2) = 20
value = 2511,0
volume = 355

[State 3025, p2state - DIZZY]
type = targetstate
trigger1 = movehit && numtarget(2533)
trigger1 = target(2533), gethitvar(hitcount) >= 20
trigger1 = (target(2533), stateno = 5000) || (target(2533), stateno = 5010) || (target(2533), stateno = 5020)
value = 7696
ID = 2533
ignorehitpause = 1

[State 3025, dizzyfx]
type = helper
trigger1 = movehit && numtarget && numhelper(2534) < 1
trigger1 = !(target, time) && (target, movetype = H)
helpertype = normal
stateno = 2534
ID = 2534
name = "Dizzy FX"
postype = p2
pos = -2, (enemynear,const(size.head.pos.y))-20-40*(enemynear,name="Piccolo Z2")
ownpal = 1
facing = -1
size.ground.front = 0
size.ground.back = 0
ignorehitpause = 1
persistent = 0

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<20,2533,1316)

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos y!=[-240,240]

;==========================================================
; GENKI- Dizzy FX
[Statedef 2534]
physics = N
velset = 0, 0
anim = 15999
sprpriority = 4

[State 3033, Assert]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State 3033, Pos]
type = posadd
trigger1 = 1
x = ceil(p2dist x)
y = ceil(p2dist y)

[State 1315, Dizzy Stars]
type=explod
trigger1 = enemynear, stateno = 5300
trigger2 = enemynear, stateno = 2912
anim = 2534
ID = 2534
sprpriority = 7
postype = p2
pos = -2, (enemynear,const(size.head.pos.y))-20-40*(enemynear,name="Piccolo Z2")
removetime = -1
ownpal=1
ignorehitpause=1
persistent = 0
pausemovetime = 100
supermovetime = 100
scale = .8,.8
bindtime = -1

[State 3033, Snd]
type = playsnd
trigger1 = enemynear, stateno = 5300
trigger2 = enemynear, stateno = 2912
value = 2522, ifelse(random < 500, 0, 1)
persistent = 0

[State 3033, End]
type = removeexplod
trigger1 = enemynear, ctrl
trigger2 = (enemynear, movetype != H)
trigger3 = (enemynear, stateno != 5300) && (enemynear, stateno != 2912)
ID = 2534

[State 3033, End]
type = destroyself
trigger1 = enemynear, ctrl
trigger1 = (enemynear, movetype != H) && (enemynear, stateno != 5300) && (enemynear, stateno != 2912)

;==========================================================
; HOPE GAUGE HELPER P1
[Statedef 2550]
physics = N
velset = 0, 0
sprpriority = 7
anim = 15999

[State 3033, Assert]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State -2, Explod];Red bar
type = Explod
trigger1 = !NumExplod(2552) && root,fvar(27)!=0
anim = 2552
pos = 96+(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 7
id = 2552
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999


[State -2, Explod];Blue bar (blink)
type = Explod
trigger1 = !NumExplod(2551) && root,fvar(27)!=0 && root,fvar(28)>=300
anim = 2551
pos = 97+(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 8
id = 2551
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Scale Blue bar
type = ModifyExplod
trigger1 = NumExplod(2551) && root,fvar(27)!=0
scale = ifelse((root,fvar(28))>=300,0.51,(root,fvar(28))/600.0),0.5
id = 2551
[State -2, Explod];Scale Blue bar
type = ModifyExplod
trigger1 = NumExplod(2556) && root,fvar(27)!=0
scale = ifelse((root,fvar(28))>=300,0.51,(root,fvar(28))/600.0),0.5
id = 2556
[State -2, Explod];Scale Blue bar
type = ModifyExplod
trigger1 = NumExplod(2557) && root,fvar(27)!=0
scale = ifelse((root,fvar(28))>=300,0.51,(root,fvar(28))/600.0),0.5
id = 2557



[State -2, Explod];MAX
type = Explod
trigger1 = !NumExplod(2555) && root,fvar(28)>=300
anim = 2555
pos = 114+(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 10
id = 2555
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

;Hope Gauge
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0
id = 2550
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0 || root,fvar(28)<300
id = 2551
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0
id = 2552
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0 || root,fvar(28)<300
id = 2555
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0 || root,fvar(28)>=150
id = 2556
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0 || root,fvar(28)<150 || root,fvar(28)>=300
id = 2557

[State -2, Explod];Red bar fades
type = Explod
trigger1 = !NumExplod(2554) && root,fvar(27)=0
anim = 2554
pos = 96+(root,var(45)),228-(root,var(46))
postype = left
removetime = 14
supermove = 1
scale = 0.5,0.5
sprpriority = 0
id = 2554
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
persistent = 0

[State -2, Explod];Hope Gauge fades
type = Explod
trigger1 = !NumExplod(2553) && root,fvar(27)=0
anim = 2553
pos = 96+(root,var(45)),228-(root,var(46))
postype = left
removetime = 14
supermove = 1
scale = 0.5,0.5
sprpriority = 7
id = 2553
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
persistent = 0


[State -2, Explod];Blue bar (blue only)
type = Explod
trigger1 = !NumExplod(2556) && root,fvar(27)!=0 && root,fvar(28)<150
anim = 2556
pos = 97+(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 8
id = 2556
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Blue bar (white only)
type = Explod
trigger1 = !NumExplod(2557) && root,fvar(27)!=0 && root,fvar(28)>=150 && root,fvar(28)<300
anim = 2557
pos = 97+(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 8
id = 2557
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Hope Gauge
type = Explod
trigger1 = !NumExplod(2550) && root,fvar(27)!=0
anim = 2550
pos = 96+(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 9
id = 2550
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 3033, End]
type = destroyself
trigger1 = root,fvar(27) != 1 && !numexplod(2553)

;==========================================================
; HOPE GAUGE HELPER P2
[Statedef 2560]
physics = N
velset = 0, 0
sprpriority = 7
anim = 15999

[State 3033, Assert]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State -2, Explod];Red bar
type = Explod
trigger1 = !NumExplod(2562) && root,fvar(27)!=0
anim = 2562
pos = 222-(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.51,0.5
sprpriority = 7
id = 2562
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Blue bar
type = Explod
trigger1 = !NumExplod(2566) && root,fvar(27)!=0 && root,fvar(28)<150
anim = 2566
pos = 222-(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 8
id = 2566
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Blue bar
type = Explod
trigger1 = !NumExplod(2567) && root,fvar(27)!=0 && root,fvar(28)>=150 && root,fvar(28)<300
anim = 2567
pos = 222-(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 8
id = 2567
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Blue bar (blink)
type = Explod
trigger1 = !NumExplod(2561) && root,fvar(27)!=0 && root,fvar(28)>=300
anim = 2561
pos = 222-(root,var(45)),228-(root,var(46))
postype = left
removetime = 4
supermove = 1
scale = 0.5,0.5
sprpriority = 8
id = 2561
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Scale Blue bar
type = ModifyExplod
trigger1 = NumExplod(2561) && root,fvar(27)!=0
scale = ifelse((root,fvar(28))>=300,0.51,(root,fvar(28))/600.0),0.5
id = 2561
[State -2, Explod];Scale Blue bar
type = ModifyExplod
trigger1 = NumExplod(2566) && root,fvar(27)!=0
scale = ifelse((root,fvar(28))>=300,0.51,(root,fvar(28))/600.0),0.5
id = 2566
[State -2, Explod];Scale Blue bar
type = ModifyExplod
trigger1 = NumExplod(2567) && root,fvar(27)!=0
scale = ifelse((root,fvar(28))>=300,0.51,(root,fvar(28))/600.0),0.5
id = 2567

[State -2, Explod];MAX
type = Explod
trigger1 = !NumExplod(2555) && root,fvar(28)>=300
anim = 2555
pos = 223-(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 10
id = 2555
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

;Hope Gauge
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0
id = 2560
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0 || root,fvar(28)<300
id = 2561
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0
id = 2562
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0 || root,fvar(28)<300
id = 2555
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0 || root,fvar(28)>=150
id = 2566
[state 17100,remove FX]
type = removeexplod
trigger1 = root,fvar(27)=0 || root,fvar(28)<150 || root,fvar(28)>=300
id = 2567

[State -2, Explod];Red bar fades
type = Explod
trigger1 = !NumExplod(2564) && root,fvar(27)=0
anim = 2564
pos = 222-(root,var(45)),228-(root,var(46))
postype = left
removetime = 14
supermove = 1
scale = 0.51,0.5
sprpriority = 0
id = 2564
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
persistent = 0

[State -2, Explod];Hope Gauge fades
type = Explod
trigger1 = !NumExplod(2563) && root,fvar(27)=0
anim = 2563
pos = 223-(root,var(45)),228-(root,var(46))
postype = left
removetime = 14
supermove = 1
scale = 0.5,0.5
sprpriority = 7
id = 2563
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999
persistent = 0

[State -2, Explod];Blue bar
type = Explod
trigger1 = !NumExplod(2566) && root,fvar(27)!=0 && root,fvar(28)<150
anim = 2566
pos = 222-(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 8
id = 2566
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Blue bar
type = Explod
trigger1 = !NumExplod(2567) && root,fvar(27)!=0 && root,fvar(28)>=150 && root,fvar(28)<300
anim = 2567
pos = 222-(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 8
id = 2567
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State -2, Explod];Hope Gauge
type = Explod
trigger1 = !NumExplod(2560) && root,fvar(27)!=0
anim = 2560
pos = 223-(root,var(45)),228-(root,var(46))
postype = left
removetime = -1
supermove = 1
scale = 0.5,0.5
sprpriority = 9
id = 2560
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 3033, End]
type = destroyself
trigger1 = root,fvar(27) != 1 && !NumExplod(2564)


;======================================================================
; KAIOKEN CHARGE AURA
[Statedef 2701]
type = A
movetype = I
physics = N
ctrl = 0
anim = 2701

velset = 0,0
sprpriority = -1

[State 1902, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1902, BindToParent]
type = BindToParent
trigger1 = anim = 2701
pos = -10,-2

[State 1902, Anim]
type = ChangeAnim
triggerall = anim = 2701
trigger1 = root,stateno != 2700
trigger1 = root,stateno != 2770
trigger1 = root,stateno != 2825
trigger1 = root,stateno != 3000
trigger1 = root,stateno != 3001
value = 2702

[State 1902, Anim]
type = ChangeAnim
triggerall = anim = 2701
trigger1 = root,anim = 2769
value = 2702

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = anim = 2701 && (Root,StateNo != 2700 && Root,StateNo != 2770 && Root,StateNo != 2825 && Root,StateNo != 3000 && Root,StateNo != 3001)
trigger2 = anim = 2702 && animtime = 0
trigger3 = Root,stateno = [5000,5090]

;------------------------------------------------
; KAIOKEN DASH TRAINEE 
[StateDef 2702] ; AftImg
type = S
movetype = I
physics = N
ctrl = 0
anim = 2703

[State 13001, Anim]
type = ChangeAnim
trigger1 = anim!= (root,anim)
value = root, anim

[State 13001, Pos]
type = BindToRoot
trigger1 = time = 0
time = -1
facing = 1

[State 13001, Pos];No push
type = PlayerPush
trigger1 = 1
value = 0

[State 13001, NoVis]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 13001, NoHit]
type = NotHitBy
trigger1 = 1
value = SCA

[State 13001, Aftimg]
type = AfterImage
trigger1 = Time = 0
time = 900
palbright = 0,-50,-50
palcontrast = 256,256,256
paladd = 100,-50,-50
palcolor = 0
trans = add1

[State 13001, EndImg]
type = AfterImageTime
trigger1 = Root, Stateno != [2703,2770]
;trigger1 = Root, Stateno != [2820,2875]
time = 1

[State 13001, End]
type = DestroySelf
trigger1 = Root, Stateno != [2703,2770]
;trigger1 = Root, Stateno != [2820,2875]

;------------------------------------------------
[StateDef 2771] ; Fade in/out effects BLACK
type = A
movetype = I
physics = N
anim = 15999
velset = 0,0

[State 13300, Expl]
type = Explod
trigger1 = Time = 30
anim = 2771
ID = 2771
postype = left
pos = -30,-30
bindtime = -1
removetime = 71
pausemovetime = 71
ontop = 1
scale = 2,2

[State 13300, Fadeout]
type = PalFX
trigger1 = Time = [30,100]
time = 1
add = 4*(Time-30),4*(Time-30),4*(Time-30)

[State 13001, End]
type = DestroySelf
trigger1 = time=101

;------------------------------------------------
; Kaioken Vertical Lines BG Hyper Kick
[Statedef 2773]
type = A
movetype = A
physics = N
anim = 2771
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = explod
trigger1 = time = 0
anim = 2773
postype = back
pos = 10,0
bindtime = -1
supermove = 0
pausemovetime = 145
sprpriority = 1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
;loop = 1
removetime = 145

[state 3250, speedlines2]
type = explod
trigger1 = time = 0
anim = 2773
postype = back
pos = 240,0
bindtime = -1
supermove = 0
pausemovetime = 145
sprpriority = 1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
;loop = 1
removetime = 145

;[State 2260, env white screen]
;type = EnvColor
;trigger1 = time = 123
;value = 245,245,245
;ignorehitpause = 0
;time = 23
;under = 0
;ignorehitpause = 1

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 145

;------------------------------------------------
; Kaioken Vertical Lines BG Nappa Finisher
[Statedef 2827]
type = A
movetype = A
physics = N
anim = 2771
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = explod
trigger1 = time = 0
anim = 2773
ID = 2773
postype = back
pos = 10,0
bindtime = -1
supermove = 0
pausemovetime = 254
sprpriority = 1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
;loop = 1
removetime = 254

[state 3250, speedlines2]
type = explod
trigger1 = time = 0
anim = 2773
ID = 2773
postype = back
pos = 240,0
bindtime = -1
supermove = 0
pausemovetime = 254
sprpriority = 1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
;loop = 1
removetime = 254

[state 3250, speedlines2]
type = removeexplod
trigger1 = root,stateno=2860 && root,animelemtime(5)=3
ID = 2773

[state 3250, speedlines]
type = explod
trigger1 = root,stateno=2860 && root,animelemtime(5)=3
anim = 12773
ID = 12773
postype = back
pos = 10,0
bindtime = -1
supermove = 0
pausemovetime = 254
sprpriority = 1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
;loop = 1
removetime = 254
persistent = 0

[state 3250, speedlines2]
type = explod
trigger1 = root,stateno=2860 && root,animelemtime(5)=3
anim = 12773
ID = 12773
postype = back
pos = 240,0
bindtime = -1
supermove = 0
pausemovetime = 254
sprpriority = 1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
;loop = 1
removetime = 254
persistent = 0

[state 3250, speedlines2]
type = removeexplod
trigger1 = root,stateno=2870 && root,Anim=1205
ID = 12773

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno=2870 && root,Anim=1205

;------------------------------------------------
; Kaioken Horizontal Lines BG Genkidama follow up (P2 Hit)
[Statedef 2922]
type = A
movetype = A
physics = N
anim = 15999
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = explod
trigger1 = time = 0
anim = 2923;+(root,facing=1)
postype = back
pos = 0,10
bindtime = -1
supermove = 0
pausemovetime = 70
sprpriority = 1
ontop = 0
ownpal = 1
;facing = 1
ignorehitpause = 1
;loop = 1
removetime = 70

[state 3250, speedlines2]
type = explod
trigger1 = time = 0
anim = 2923;+(root,facing=1)
postype = back
pos = 0,240
bindtime = -1
supermove = 0
pausemovetime = 70
sprpriority = 1
ontop = 0
ownpal = 1
;facing = 1
ignorehitpause = 1
;loop = 1
removetime = 70

;[State 2260, env]
;type = EnvColor
;trigger1 = time = 123
;value = 245,245,245
;ignorehitpause = 0
;time = 23
;under = 0
;ignorehitpause = 1

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 70

;------------------------------------------------
; Kaioken Horizontal Lines BG Genkidama follow up (Genkidama Ball)
[Statedef 2937]
type = A
movetype = A
physics = N
anim = 15999
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = explod
trigger1 = time = 0
anim = 2923;+(root,facing=1)
ID = 2923
postype = back
pos = 0,10
bindtime = -1
supermove = 0
sprpriority = 1
ontop = 0
ownpal = 1
ignorehitpause = 1
removetime = 200

[state 3250, speedlines2]
type = explod
trigger1 = time = 0
anim = 2923;+(root,facing=1)
ID = 2923
postype = back
pos = 0,240
bindtime = -1
supermove = 0
sprpriority = 1
ontop = 0
ownpal = 1
ignorehitpause = 1
removetime = 200

[State 2260, destroy movie 7]
type = RemoveExplod
trigger1 = root,stateno=2965
ID = 2923

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 200

;------------------------------------------------
; Kaioken Horizontal Lines BG Genkidama Movie 7 follow up
[Statedef 2956]
type = A
movetype = A
physics = N
anim = 15999
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = explod
trigger1 = time = 0
anim = 2923;+(root,facing=1)
ID = 2923
postype = back
pos = 0,10
bindtime = -1
supermove = 0
sprpriority = 1
ontop = 0
ownpal = 1
ignorehitpause = 1
removetime = 95

[state 3250, speedlines2]
type = explod
trigger1 = time = 0
anim = 2923;+(root,facing=1)
ID = 2923
postype = back
pos = 0,240
bindtime = -1
supermove = 0
sprpriority = 1
ontop = 0
ownpal = 1
ignorehitpause = 1
removetime = 95

[State 2260, destroy movie 7]
type = RemoveExplod
trigger1 = root,stateno=2965
ID = 2923

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 100

;------------------------------------------------
; Limit basics comboability
[Statedef 15999]
type    = S
movetype= A
physics = N
anim = 15999
sprpriority = -5

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, destroy]
type = DestroySelf
trigger1 = numenemy
trigger1 = enemynear, movetype != H || (enemynear, stateno = [120,155]) || enemynear, ctrl
trigger2 = time = 24


;------------------------------------------------
;Pulse Effect during fall recovery (taken from Possessed Heita by The_None)
[Statedef 52100]
type    = S
movetype = I
physics = S
sprpriority = 4
anim = 15999
ctrl = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT

[State 0, PosAdd]
type = PosAdd
trigger1 = 1
x = ifelse(root,stateno=5201,ceil(parentdist x/3.0),parentdist x)
y = parentdist y

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(0) = parent,anim

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(1) = parent,animelemno(0)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time
value = var(0)
elem = var(1)

[State 0, VarSet]
type = VarAdd
trigger1 = time
fvar(0) = 11.2

[State 0, VarSet]
type = VarAdd
trigger1 = time
fvar(1) = 0.015

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 1+fvar(1),1+fvar(1)

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
add = floor(0-fvar(0)),floor(0-fvar(0)),floor(0-fvar(0))

[State 0, ]
type = DestroySelf
trigger1 = root,stateno != 5201
trigger1 = root,stateno != 5210

;===================================================
;GENKIDAMA CHARGE FX BALLS
[Statedef 2504]
type = A
movetype = I
physics = N
anim = 15999

[State 1005, VarRandom]
type = VarSet
trigger1 = !time
fvar(20) = 0.01*(random%10)

[State 1003, Helper]
type = Helper
trigger1 = !time
helpertype = Normal
name = "PerseEffect"
id = 2505
pos = ((random%240)-120),((random%240)-120)
postype = p1
facing = 1
stateno = 2505
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .1 - (.1*fvar(20))
size.yscale = .1 - (.1*fvar(20))

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = time=2

;PerseEffect
[Statedef 2505]
type = A
movetype = I
physics = N
anim = 2505
sprpriority = 4

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 1004, vel]
type = velset
triggerall = root,stateno != 2930
trigger1 = !time
x = (rootdist x-14)/60
y = (rootdist y-70)/75

[State 1004, vel]
type = velset
triggerall = root,stateno = 2930
trigger1 = !time
x = (rootdist x-14)/60
y = (rootdist y-190)/75

[State 41, Train]
type = AfterImage
trigger1 = !Time
time = 25
timegap = 1
framegap = 1
length = 8
palbright = 0,0,0
paladd = 0,0,50
palmul = .9,.9,.9
palcontrast = 120,120,120
palpostbright = 0,0,0
trans = add1

[state 1004, effect]
type = palfx
trigger1 = (root,anim != 2500) && (root,anim != 2503) && (root,anim != 2910)
trigger2 = (RootDist X <= 70) && (RootDist Y <= 70)
time = 1
add = ceil(100-(Time)*10),ceil(100-(Time)*10),ceil(100-(Time)*10)

[state 1004, effect]
type = palfx
trigger1 = (root,anim = 15999)
time = 1
add = -255,-255,-255

[State 1004, DestroySelf]
type = DestroySelf
trigger1 = (ParentDist X <= 10) && (ParentDist Y <= 5) && (Time > 55)
trigger2 = time > 300

;===================================================
;GENKIDAMA CHARGE FX BALLS GENKIDAMA KAIOKEN
[Statedef 2931]
type = A
movetype = I
physics = N
anim = 15999

[State 1005, VarRandom]
type = VarSet
trigger1 = !time
fvar(20) = 0.01*(random%10)

[State 1003, Helper]
type = Helper
trigger1 = !time
helpertype = Normal
name = "PerseEffect"
id = 2932
;pos = ((random%240)-120),((random%240)-120)
pos = ceil(50-random/10),-ceil(random/10)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .1 - (.1*fvar(20))
size.yscale = .1 - (.1*fvar(20))

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = time=2

;PerseEffect
[Statedef 2932]
type = A
movetype = I
physics = N
anim = 2505
sprpriority = 4
velset = (random%9)-4,-1-(random%3)

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 1004, vel]
type = veladd
trigger1 = time>10
x = (rootdist x-14)/120.0
y = (rootdist y-190)/150.0

[State 41, Train]
type = AfterImage
trigger1 = !Time
time = 25
timegap = 1
framegap = 1
length = 8
palbright = 0,0,0
paladd = 0,0,50
palmul = .9,.9,.9
palcontrast = 120,120,120
palpostbright = 0,0,0
trans = add1

[state 1004, effect]
type = palfx
trigger1 = (root,anim != 2500) && (root,anim != 2503) && (root,anim != 2910)
trigger2 = (RootDist X <= 70) && (RootDist Y <= 70)
time = 1
add = ceil(100-(Time)*10),ceil(100-(Time)*10),ceil(100-(Time)*10)

[state 1004, effect]
type = palfx
trigger1 = (root,anim = 15999)
time = 1
add = -255,-255,-255

[State 1004, DestroySelf]
type = DestroySelf
;trigger1 = (ParentDist X <= 10) && (ParentDist Y <= 5) && (Time > 55)
trigger1 = rootdist y >= 180
trigger2 = time > 300

;===================================================
; Kinton Cloud intro
[Statedef 19300]
type    = S
movetype= A
physics = N
anim = 19300
sprpriority = 2-4*((random%3)=0)

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, BindToRoot]
type = BindToRoot
trigger1 = root,anim = 193
trigger2 = root,anim = 194
time = 1
pos = -5,0
ignorehitpause =  1

[State 0, velset]
type = SprPriority
trigger1 = time = 270
value = -4

[State 181, cloud leaves]
type = PlaySnd
trigger1 = root,anim = 0
value = 193, 2
channel = 8
persistent = 0

[State 0, velset]
type = VelAdd
trigger1 = root,anim = 0
X = 1

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 500
trigger2 = root, StateNo = 745

;------------------------------------------------
; Kinton Cloud winpose
[Statedef 18602]
type    = S
movetype= A
physics = N
anim = 19300
sprpriority = -2

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, velset]
type = VelSet
trigger1 = !time
X = 10

[State 0, velset]
type = VelSet
trigger1 = (parentdist X >= -5) && (parentdist X <= 5)  ;time=60
X = 0

[State 0, BindToRoot]
type = BindToRoot
trigger1 = root,anim = 193
trigger2 = root,anim = 194
time = 1
pos = -5,0
ignorehitpause =  1

[State 0, velset]
type = SprPriority
trigger1 = root,anim = 44
value = 2

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 500

;------------------------------------------------
; Shenron
[Statedef 19400]
type    = S
movetype= A
physics = N
anim = 19400
sprpriority = -2

[State 200, BGPalFX]
type = BGPalFX
trigger1 = time<327
time = 1
add	= -20,-20,-20
mul	= 100,100,100
invertall = 0
color = 256

[State 200, TimeCount]
type = VarAdd
trigger1 = root,anim = 0
var(0) = 1

[State 200, BGPalFX]
type = BGPalFX
trigger1 = Time <500 ;root,anim = 0
time = 1
add	= ceil(-20+.6*Var(0)),ceil(-20+.6*Var(0)),ceil(-20+.6*Var(0))
mul	= ceil(100+1.5*var(0)),ceil(100+1.5*var(0)),ceil(100+1.5*var(0))
invertall = 0
color = 256

[State 200, BGPalFX]
type = BGPalFX
trigger1 = Time >380 ;root,anim = 0
time = 1
invertall = 0
color = 256

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, BindToRoot]
type = BindToRoot
trigger1 = root,anim = 194
time = 1
pos = 0,0
ignorehitpause =  1

[State 0, velset]
type = SprPriority
trigger1 = time = 270
value = -4

[State 0, velset]
type = VelSet
trigger1 = root,anim = 0
X = 2.5
Y = -4

[state 17100, smoke FX]
type=explod
trigger1 = root,anim = 0
anim=19402
pos = 70,155
postype=P1
sprpriority=-2
ownpal=1
supermovetime=-1
removetime = -2
persistent = 0
vel = 2., 0
[state 17100, smoke FX]
type=explod
trigger1 = root,anim = 0
anim=19403
pos = -40,155
postype=P1
sprpriority=-2
ownpal=1
supermovetime=-1
removetime = -2
persistent = 0
vel = 2., 0

[State 3001, Ground shake]
type = envshake
;trigger1 = root,anim = 0
trigger1 = Time = [327,400]
trigger1 = !(time%4)
time = 4
freq = 80
ampl = 4+.01*(time-280)






[State 3001, flying away]
type = playsnd
trigger1 = root,anim = 0
value = 194,1
channel = 8
persistent = 0




[State 2260, destroy]
type = DestroySelf
trigger1 = time = 540;380
trigger2 = root, StateNo = 745

;------------------------------------------------
; SSJ3 Hair
[Statedef 18800]
type    = S
movetype= A
physics = N
anim = 903
sprpriority = 6

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
pos = 0,0
ignorehitpause =  1

[State 1000, flash]
type = PalFX
trigger1 = !(time%60)
add = 100,100,100
sinadd = 40,40,40,60
time = 60

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 600

;------------------------------------------------
; Big Ball Beam Collision
[Statedef 2483]
type    = S
movetype= A
physics = N
anim = 15999
sprpriority = 7

[state 17100,move ball FX]
type = Posset
trigger1 = 1
X = floor(160.0*((root,fvar(20))-.5))*(root,facing)
Y = -47

[State -2, Explod];Big Ball at center
type = Explod
trigger1 = !numexplod(2483) && !time
anim = 2483
removetime = -1
sprpriority = 6
id = 2483
bindtime = -1
ownpal = 1
postype = p1
pos = 0,0
scale = .45,.45
ignorehitpause = 1
pausemovetime = 99999
supermovetime = 99999
facing = root,facing

[State 1305, timevar]
type = varadd
trigger1 = root,stateno != 2489
var(4) = 1

[State 1305, Scale Explod]
type = ModifyExplod
trigger1 = root,stateno = 2489
scale = 0.7+.1*(time-var(4)),0.7+.1*(time-var(4))
ID = 2483

[State 13100, explosion SND]
type = playsnd
trigger1 = root,stateno = 2489
trigger1 = time-var(4) = 0
value = 2483,0
volume = 255

[State 2260, destroy]
type = RemoveExplod
trigger1 = root,stateno != 2481
trigger1 = root,stateno != 2489

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno != 2481
trigger1 = root,stateno != 2489

;==========================================================
; GENKIDAMA KAIOKEN HELPER
[Statedef 2936]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[state 1215, Smoke FX]
type = explod
trigger1 = time = 40
anim = 8060   ;1206+(root,var(2)=0)
id = 1206
pos = -80,70
;postype = P1
bindtime = -1
sprpriority = 6
ownpal = 1
removetime = 155
persistent = 0
ignorehitpause = 1

[state 1215, Smoke FX]
type = explod
trigger1 = time = 195
anim = 8061   ;1206+(root,var(2)=0)
id = 1206
pos = -80,70
;postype = P1
bindtime = 1
sprpriority = 6
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = !time && (var(3)<1)
x = 12
y = 3

[State 1061, Velocity];anti-misfire fix = give small velocity when hitting
type = VelSet
trigger1 = !time && (var(3)=1)
x = 6

[State 1061, Velocity]
type = VelSet
trigger1 = time=40 && (var(3)<2)
x = -5
y = 0

[State 1061, Velocity]
type = VelSet
trigger1 = pos X <= 0 && time>40 && (var(3)<2) && facing=1
trigger2 = pos X >= 0 && time>40 && (var(3)<2) && facing=-1
x = 0

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2523

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1
[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA
ignorehitpause = 1

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;15,0   ;ceil(9 + root,fvar(28)*25.0/660.0),0    ;Formula : fvar(28)*250/(300*22)
damage    = ceil(IfElse(root,fvar(11) * 40 < 1, 1, root,fvar(11) * 40)), 0
getpower = 0,0
givepower = 35,35
pausetime = 3*(var(2)<10),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity = 0, ifelse(var(2)<10, 0, -12)
guard.velocity = -9
air.velocity = 0, ifelse(var(2)<10, 0, -12)
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=10)
air.fall = 1
fall.recover = 0
sparkno = -1
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
kill = 0
forcestand = 1
p1sprpriority = 5

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 1315, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=ifelse(var(2)=10,2512,7020)
scale=ifelse(var(2)=10,1.3,1),ifelse(var(2)=10,1.3,1)   ;1.5 before
sprpriority=7
postype=p2
pos=(target,const(size.ground.front)-10),-floor(p2dist y)
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
persistent=0
pausemovetime=100
supermovetime=100

[State 13100, explosion SND]
type = playsnd
triggerall = movecontact=1 && numtarget
trigger1 =  movehit=1 && numenemy
trigger1 = var(2) = 10
value = 2511,0
volume = 355

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<10,2936,ifelse(movehit,2938,1316))

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

;-------------------------------------
[Statedef 2938]; Genkidama Kaioken waits
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
velset = 2,0

[State 1061, not too close to edge]
type = Velset
trigger1 = FrontEdgeDist < 30
X = 0
Y = 0

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 2531

[state 17100, Wave Effect]
type=explod
trigger1 = time = 25
anim=2205+(root,var(2)=1)
id=2205
pos=0,-floor(p2dist y)
postype=P1
sprpriority=7
ownpal=1
supermovetime=-1
removetime = -2

[state 17100, Wave Effect]
type=explod
trigger1 = time = 25
anim=2517
id=2205
pos=0,0
postype=P1
sprpriority=6
ownpal=1
supermovetime=-1
removetime = -2

[State 3005, end]
type = changestate
trigger1 = time > 25
value = 2939

;-------------------------------------
[Statedef 2939]; Genkidama Kaioken goes up
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5
velset = 0,0

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 0.8
ignorehitpause = 1

[State 3005, scale]
type = AngleDraw
trigger1 = var(2)<22
value = 0
scale = 1.1+0.08*(var(2)-10),1.1+0.08*(var(2)-10)
[State 3005, scale]
type = AngleDraw
trigger1 = var(2)=22
value = 0
scale = 2.3,2.3

[State 3005, anim]
type = changeanim
trigger1 = !time
value = 2531

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1


[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
y = ifelse((time<2 && var(2)>1),-4,-10)

[State 1315, image]
type = afterimage
trigger1 = !time
time = 999
timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;15,0   ;ceil(9 + root,fvar(28)*25.0/660.0),0    ;Formula : fvar(28)*250/(300*22)
damage    = ceil(IfElse(root,fvar(11) * 15 < 9, 9, root,fvar(11) * 15)), 7
getpower = 0,0
givepower = 35,35
pausetime = 7,0
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<22, ifelse(var(2)%2=0,2,-2), -2), ifelse(var(2)<22, -2, -7)
guard.velocity = -9
air.velocity =  ifelse(var(2)<22, ifelse(var(2)%2=0,2,-2), -2), ifelse(var(2)<22, -3, -7)
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=22)
air.fall = 1
fall.recover = 0
sparkno = -1
hitsound   = s2400,3
guardsound = S6,0
p2facing = ifelse(var(2)=22,1,ifelse(var(2)%2=0,-1,1))
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
ID = 2533
kill=(var(2)>=21)  ;>=22 was fine in Winmugen, but 21 is needed in 1.0 (???)
p1sprpriority = 5

[state 1215, Horizontal lightning]
type = explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim = ifelse(var(2)%2=0,2515,2516)
id = 2515
pos = (target,const(size.ground.front)-20),-floor(p2dist y)+(target,const(size.mid.pos.y))
postype = p2
sprpriority = 4
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
pausemovetime=100
supermovetime=100
scale = 0.6,0.6

[State 1315, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=ifelse(var(2)>=20,2512,7020)
scale=ifelse(var(2)>=20,1.6,1),ifelse(var(2)>=20,1.6,1)
sprpriority=7
postype=p2
pos=(target,const(size.ground.front)-10),-floor(p2dist y)-40*(var(2)>=20)
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
persistent=0
pausemovetime=100
supermovetime=100

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = movehit && numtarget
time = 2
color = 0
invertall = 1
ignorehitpause = 1
persistent = 0

[State 13100, explosion SND]
type = playsnd
triggerall = movecontact=1 && numtarget
trigger1 =  movehit=1 && numenemy
trigger1 = var(2) >= 20
value = 2511,0
volume = 355

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<22,2939,1316)

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos y!=[-240,240]

;------------------------------------------------
; Kaioken Vertical Lines BG Kaioken End
[Statedef 2940]
type = A
movetype = A
physics = N
anim = 2771
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = explod
trigger1 = time = 0
anim = 2773
postype = back
pos = 10,0
bindtime = -1
supermove = 0
pausemovetime = 140
sprpriority = 1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
;loop = 1
removetime = 140

[state 3250, speedlines2]
type = explod
trigger1 = time = 0
anim = 2773
postype = back
pos = 240,0
bindtime = -1
supermove = 0
pausemovetime = 140
sprpriority = 1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
;loop = 1
removetime = 140

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 140

;------------------------------------
;KI BLAST KAIOKEN HELPER
[Statedef 2904]
type    = S
movetype= A
physics = N
anim = 1010
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, gethit gut ?]
type = VarSet
trigger1 = !time
var(14) = root,var(14)

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 9

[State 1061, Velocity]
type = VelSet
trigger1 = Movehit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = var(14)=0
attr = S, SP
animtype  = hard
;10,0
damage    = ceil(IfElse(root,fvar(11) * 10 < 7, 7, root,fvar(11) * 10)), 0
priority  = 4,Hit
hitflag = MAF
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = high
air.type = low
ground.slidetime = 50
ground.hittime  = 50
ground.velocity = -7.8,0
guard.velocity = -7.5
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
yaccel = 0.5
fall = 0
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 35,35
forcestand = 1
kill = 0
p1sprpriority = 5

[State 1061, Hitdef]
type = HitDef
trigger1 = var(14)=1
attr = S, SP
animtype  = hard
;10,0
damage    = ceil(IfElse(root,fvar(11) * 10 < 7, 7, root,fvar(11) * 10)), 0
priority  = 4,Hit
hitflag = MAF
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = low
air.type = low
ground.slidetime = 50
ground.hittime  = 50
ground.velocity = -7.8,0
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
yaccel = 0.5
fall = 0
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 35,35
forcestand = 1
kill = 0
p1sprpriority = 5

[State 1061, End]
type = destroyself
trigger1 = (pos x!=[-240,240])
trigger2 = time>180

[State 1061, Fade]
type = changestate
trigger1 = movecontact
value = 1013
ignorehitpause=1

;------------------------------------
;KI BLAST KAIOKEN HELPER (FORCES TO STAND)
[Statedef 12904]
type    = S
movetype= A
physics = N
anim = 1010
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 9

[State 1061, Velocity]
type = VelSet
trigger1 = Movehit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = 1
attr = S, SP
animtype  = hard
;10,0
damage    = ceil(IfElse(root,fvar(11) * 10 < 7, 7, root,fvar(11) * 10)),0
priority  = 4,Hit
hitflag = MAF
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = high
air.type = low
ground.slidetime = 50
ground.hittime  = 50
ground.velocity = -7.8,0
guard.velocity = -7.5
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
yaccel = 0.5
fall = 0
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 35,35
forcestand = 1
kill = 0
p1sprpriority = 5
;p2stateno = 12901
id = 12901

[State 0, TargetState]  
type = TargetState
trigger1 = Numtarget(12901)
trigger1 = movehit = 1
value = 12901
ID = 12901
ignorehitpause = 1
persistent = 0

[State 1061, Fade]
type = changestate
trigger1 = movecontact
value = 1013
ignorehitpause=1

;------------------------------------
;INVISIBLE KI BLAST EXPLOSION KAIOKEN
[Statedef 12905]
type    = S
movetype= A
physics = N
anim = 2906
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;[State 1061, Velocity]
;type = VelSet
;trigger1 = Time = 0
;x = 15

[State 1061, Velocity]
type = VelSet
trigger1 = Movehit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA
ignorehitpause = 1

[State 1061, Hitdef]
type = HitDef
trigger1 = 1
attr = S, SP
animtype  = hard
;10,0
damage    = ceil(IfElse(root,fvar(11) * 10 < 7, 7, root,fvar(11) * 10)), 0
priority  = 4,Hit
hitflag = MAF
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,0
ground.type = high
air.type = low
ground.slidetime = 50
ground.hittime  = 50
ground.velocity = -7.8,0
guard.velocity = -7.5
envshake.time = 5
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 35,35
forcestand = 1
kill = 0
p1sprpriority = 5
;p2stateno = 2906
id = 2906

[State 0, TargetState]  
type = TargetState
trigger1 = Numtarget(2906)
trigger1 = movehit = 1
value = 2906
ID = 2906
ignorehitpause = 1
persistent = 0

[State 1315, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=2512
sprpriority=7
postype=p2
pos=(target,const(size.ground.front)-10),-floor(p2dist y)
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
persistent=0
pausemovetime=100
supermovetime=100

[State 13100, explosion SND]
type = playsnd
triggerall = movecontact=1 && numtarget
trigger1 =  movehit=1 && numenemy
value = 2511,0
volume = 355

[State 1061, End]
type = destroyself
trigger1 = movecontact

;------------------------------------
;CHICHI HELPER CATCHED
[Statedef 702]
type    = S
movetype= I
physics = N
anim = 702
sprpriority = 2

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 20
y = 10

[State 1061, Catched]
type = ChangeAnim
trigger1 = Time = 48
value = 703

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 48
y = 0

[State 1061, bind]
type = BindtoRoot
trigger1 = Time >= 48
pos = 0,0

;------------------------------------
;CHICHI HELPER THROWN
[Statedef 707]
type    = S
movetype= I
physics = N
anim = 707
sprpriority = 2

[State 1061, Velocity]
type = VelSet
trigger1 = AnimElemTime(4) = 0
y = -10

[State 1061, destroy]
type = Destroyself
trigger1 = AnimElemTime(4) = 40
trigger2 = root, StateNo = 745

;------------------------------------
;VALENTINE'S HEART HELPER (not used)
[Statedef 704]
type    = S
movetype= I
physics = N
anim = 704
sprpriority = -4

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1061, scale]
type = AngleDraw
trigger1 = 1
value = 0
scale = 2+sin(.05*Time),2+sin(.05*Time)

;------------------------------------
;KATAMARI HELPER
[Statedef 721]
type    = S
movetype= I
physics = N
anim = 721
sprpriority = 8

[State 725, move to middle]
type = PosAdd
triggerall = time > 50 && pos X > 0
trigger1 = pos X > 40
X = ifelse(facing=1,-6,6)
[State 725, move to middle]
type = PosAdd
triggerall = time > 50 && pos X > 0
trigger1 = pos X > 35
X = ifelse(facing=1,-4,4)
[State 725, move to middle]
type = PosAdd
triggerall = time > 50 && pos X > 0
trigger1 = pos X > 25
X = ifelse(facing=1,-2,2)
[State 725, move to middle]
type = PosAdd
triggerall = time > 50 && pos X > 0
trigger1 = pos X > 5
X = ifelse(facing=1,-1,1)
[State 725, move to middle]
type = PosAdd
triggerall = time > 50 && pos X < 0
trigger1 = pos X < -40
X = ifelse(facing=-1,-6,6)
[State 725, move to middle]
type = PosAdd
triggerall = time > 50 && pos X < 0
trigger1 = pos X < -35
X = ifelse(facing=-1,-4,4)
[State 725, move to middle]
type = PosAdd
triggerall = time > 50 && pos X < 0
trigger1 = pos X < -25
X = ifelse(facing=-1,-2,2)
[State 725, move to middle]
type = PosAdd
triggerall = time > 50 && pos X < 0
trigger1 = pos X < -5
X = ifelse(facing=-1,-1,1)

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 135
y = 10

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 165
y = 0

;--------------------------------------
;Blue prize BG Helper
[Statedef 722]
type = S
movetype = I
physics = N
anim = 722
sprpriority = 7

[State 1061, TADA SFX]
type = Playsnd
trigger1 = !Time
value = 720,2

[State 1004, assert]
type = angledraw
trigger1 = 1
value = 4*time
scale = .7,.7
ignorehitpause = 1

;[State 1004, DestroySelf]
;type = DestroySelf
;trigger1 = time > 130

;------------------------------------
;CAR HELPER
[Statedef 726]
type    = S
movetype= I
physics = N
anim = 726
sprpriority = 6

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 135
y = 10

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 165
y = 0

[State 1061, glass break SFX]
type = Playsnd
trigger1 = Time = 165
value = 725,1

[State 1000, Helper]
type = Helper
trigger1 = (time>165) && (time<210) && numhelper(727)<30 && numhelper(728)<30
helpertype = Normal
name = "GlassEffect"
id = 727
pos = ceil(30-random/11.0),-80+ceil(random/50)
postype = p1
facing = 1
stateno = 727
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

;-------------------------------
;Glass Generator (Shards)
[Statedef 727]
type = A
movetype = I
physics = N
anim = 15999

[State 1003, Helper]
type = Helper
trigger1 = !time
helpertype = Normal
name = "GlassEffect"
id = 728
pos = 0,0
postype = p1
facing = 1
stateno = 728
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = time=2

;GlassEffect
[Statedef 728]
type = A
movetype = I
physics = N
anim = 727 + (random%3)
velset = 0, 1+0.1*(random%8)
sprpriority = 9

[State 1005, VarRandom]
type = VarSet
trigger1 = !time
fvar(20) = random%2

[State 1004, assert]
type = angledraw
trigger1 = 1
value = ifelse(fvar(20)=1,5*time,-5*time)

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 1405, No hits]
type = NotHitBy
trigger1 = 1
value = SCA

[State 1416, Gravity]
type = Gravity
trigger1 = 1

[State 1415, Hit Floor]
type = ChangeState
trigger1 = Pos Y >= 0
value = 729

;Touches the floor
[Statedef 729]
type = A
movetype = A
physics = N
velset = ifelse(random%2,1.5+0.1*(random%10),-1.5-0.1*(random%10)), -3-(random%4)
sprpriority = 9

[State 1011, Override]
type = NotHitBy
trigger1 = 1
value = SCA

[State 1004, assert]
type = angledraw
trigger1 = 1
value = ifelse(vel X>0,5*time,-5*time)

[State 1416, Reset Pos]
type = PosSet
trigger1 = !Time
Y = 0

[State 1406, Gravity]
type = Gravity
trigger1 = 1

[State 1406, No Shadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1415, Hit Floor]
type = ChangeState
trigger1 = (Pos Y >= 0) && time>1
value = 7290

;Touches the floor
[Statedef 7290]
type = A
movetype = A
physics = N
sprpriority = 9

[State 1011, loop var]
type = Varadd
trigger1 = !time
var(33) = 1

[State 1011, time var]
type = Varadd
trigger1 = var(33)<3
var(12) = 1

[State 1011, Override]
type = NotHitBy
trigger1 = 1
value = SCA

[State 1011, vels]
type = Velset
trigger1 = !time && var(33)<3
Y = -3-(random%3)+var(33)

[State 1011, vels]
type = Velmul
trigger1 = 1
x = 0.98

[State 1004, assert]
type = angledraw
trigger1 = 1
value = ifelse(vel X>0,-5*var(12),5*var(12))
scale = 1,ifelse(var(33)<3,1,.5)

[State 1416, Reset Pos]
type = PosSet
trigger1 = !Time
Y = 0

[State 1406, Gravity]
type = Gravity
trigger1 = 1

[State 1406, No Shadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1406, Stop]
type = PosFreeze
trigger1 = Var(33)=3

[State 1415, Hit Floor]
type = ChangeState
trigger1 = (Pos Y >= 0) && time>1 && var(33)<3
value = 7290

;[State 1416: Dies]
;type = DestroySelf
;trigger1 = Time >= 60

;------------------------------------
;OPTIMUS HELPER
[Statedef 731]
type    = S
movetype= I
physics = N
anim = 731
sprpriority = 5  ;-2

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 135
y = 10

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 165
y = 0

[state 17100, Optimus Leg]
type=explod
trigger1 = Time = 165
anim=732
id=732
pos=0,0
postype=P1
sprpriority=6
ownpal=1
supermovetime=-1
removetime = -1
persistent = 0
scale = 1,1
bindtime = -1

;------------------------------------
;SCREEN MOVE HELPER
[Statedef 732]
type    = S
movetype= I
physics = N
anim = 15999
sprpriority = -2

[State 181, remove stuff]
type = Assertspecial
trigger1 = 1
flag = nobardisplay

[State 1061, Velocity]
type = VelAdd
triggerall = time<170
trigger1 = Time>=10 && (vel Y > -4)
y = -.2

[State 3010, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 170
y = 0

;------------------------------------
;GREGORY HELPER
[Statedef 18710]
type    = A
movetype= I
physics = N
anim = 18710
sprpriority = 2

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 20
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 20
x = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 21
x = -14
y = -6
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 30
x = 0
y = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 31
x = -4
y = 14
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 40
x = 0
y = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 41
x = 20
y = -6
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 50
x = 0
y = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 51
x = -4
y = 8
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 57
x = 0
y = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 58
x = -7
y = -7
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 75
x = 0
y = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 76
x = 2
y = 18
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 80
x = 0
y = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 81
x = 8
y = -8
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 90
x = 0
y = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 90
x = 9
y = 5.5
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 98
x = 0
y = 0

[State 1061, moving sound]
type = PlaySnd
trigger1 = Time = 0
trigger2 = Time = 21
trigger3 = Time = 31
trigger4 = Time = 41
trigger5 = Time = 51
trigger6 = Time = 58
trigger7 = Time = 76
trigger8 = Time = 81
trigger9 = Time = 90
value = 189,0
persistent = 1

[State 1061, moving twinkle sound]
type = PlaySnd
trigger1 = Time = 0
trigger2 = Time = 58
value = 189,1
persistent = 1

[State 1061, spotted]
type = ChangeAnim
trigger1 = Time = 97
Value = 18711

;[State 1061, de spotted]
;type = ChangeAnim
;trigger1 = Time = 118
;Value = 18710

[State 1061, Velocity]
type = VelSet
trigger1 = Time >= 118
y = 2*sin(time/6.0)

[State 1315, Dizzy Stars]
type=explod
trigger1 = Time = 118
anim = 2534
sprpriority = 7
postype = p1
pos = -2, (enemynear,const(size.head.pos.y))-20-40*(enemynear,name="Piccolo Z2")
removetime = -1
ownpal = 1
;bindtime = -1
ignorehitpause=1
persistent = 0
pausemovetime = 100
supermovetime = 100
scale = .8,.8

[State 3033, Snd]
type = playsnd
trigger1 = Time = 118
value = 2522, ifelse(random < 500, 0, 1)
persistent = 0

;------------------------------------
;HAMMER HELPER
[Statedef 18714]
type = A
movetype = I
physics = N
anim = 18714
velset = 0, 1
sprpriority = 4

[State 1405, No hits]
type = NotHitBy
trigger1 = 1
value = SCA

[State 1416, Gravity]
type = Gravity
trigger1 = (Pos Y < 0)

[State 1415, Hit Floor]
type = PosSet
trigger1 = (Pos Y >= 0)
Y = 0

[State 1415, Hit Floor]
type = VelSet
trigger1 = (Pos Y >= 0)
Y = 0

[State 1415, Hit Floor]
type = ChangeAnim
trigger1 = (Pos Y = 0)
value = 18715

[State 1415, Hit Floor]
type = PlaySnd
trigger1 = (Pos Y = 0)
value = 720,1
volume = 500
persistent = 0

[State 4001, BAM]
type = Envshake
trigger1 = (Pos Y = 0)
time = 15
freq = 100
ampl = 7
persistent = 0

;---------------------------
;Detect life Helper (Coded by 2OS)
[Statedef 2]

[State 2OS]
type = statetypeset
trigger1 = 1
movetype = I
ignorehitpause = 1
persistent = 1

[State 2OS, Blank Animation]
type = changeanim
trigger1 = 1
value = 15999
ignorehitpause = 1
persistent = 1

[State 2OS]
type = bindtoroot
trigger1 = 1
pos = 0,0
ignorehitpause = 1
persistent = 1

[State 2OS, Damage Var Delay Reset]
type = varset
trigger1 = var(1)>1
var(1) = 0
ignorehitpause = 1
persistent = 1

[State 2OS, Damage Var Delay]
type = varadd
trigger1 = var(2) != root,life
var(1) = 1
ignorehitpause = 1
persistent = 1

[State 2OS, Damage Var]
type = varset
trigger1 = (var(1)!=[0,1])
var(2) = root,life
ignorehitpause = 1
persistent = 1


;------------------------------------------------
; Shenron for prize winpose
[Statedef 712]
type    = S
movetype= I
physics = N
anim = 19400
sprpriority = 4

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 3000, Shenron close body]
type = helper
trigger1 = time = 0
helpertype = normal
stateno = 713
name = "shenron_close_body"
postype = p1
pos = 0,0
ownpal = 1

[State 3000, Shenron far body]
type = helper
trigger1 = time = 0
helpertype = normal
stateno = 714
name = "shenron_far_body"
postype = p1
pos = 0,0
ownpal = 1

[State 3001, wish granted]
type = playsnd
triggerall = root,var(55)=0		;Voice=Japan
trigger1 = time=70
value = 710,1

[State 3001, wish granted]
type = playsnd
triggerall = root,var(55)=1		;Voice=English
trigger1 = time=70
value = 710,2

[State 1315, Glowing eye]
type=explod
trigger1 = Time = 80
anim = 19404
sprpriority = 7
postype = p1
pos = 0, 0
removetime = -2
ownpal = 1
bindtime = -1
ignorehitpause=1
persistent = 0

[State 0, velset]
type = VelSet
trigger1 = time=120
X = -5

[State 3001, flying away]
type = playsnd
trigger1 = time=120
value = 194,1
channel = 8
persistent = 0

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 200

;------------------------------------------------
; Shenron close body
[Statedef 713]
type    = S
movetype= I
physics = N
anim = 15999

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 13300, black screen fade]
type = Explod
trigger1 = !Time
anim = 2771
ID = 2771
postype = left
pos = 0,-50
bindtime = -1
removetime = 300
pausemovetime = 300
sprpriority = 5
scale = 2,3

[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = -296, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = -222, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = -148, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = -74, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = 0, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = 74, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = 148, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 20
bindtime = -1
[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = 222, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, close body 1]
type=explod
trigger1 = !Time
anim = 19405
sprpriority = 4
postype = p1
pos = 296, 35
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1

[State 13300, Fadeout]
type = PalFX
trigger1 = Time >= 120
time = 1
add = 3*(Time-120),3*(Time-120),3*(Time-120)

[State 0, velset]
type = VelSet
trigger1 = time=120
X = 3

[State 2260, destroy]
type = RemoveExplod
trigger1 = time = 200

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 200

;------------------------------------------------
; Shenron far body
[Statedef 714]
type    = S
movetype= I
physics = N
anim = 15999
sprpriority = 5

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 13300, black screen fade]
type = Explod
trigger1 = !Time
anim = 2771
ID = 2771
postype = left
pos = 0,-50
bindtime = -1
removetime = 300
pausemovetime = 300
sprpriority = 5
scale = 2,3

[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = -41, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 0, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 41, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 82, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 123, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 164, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 205, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 246, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 287, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 328, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1
[State 1315, far body 1]
type=explod
trigger1 = !Time
anim = 19406
sprpriority = 4
postype = p1
pos = 369, 130
ID = 19405
removetime = -1
ownpal = 1
ignorehitpause=1
persistent = 0
bindtime = -1

[State 13300, Fadeout]
type = PalFX
trigger1 = Time >= 120
time = 1
add = 3*(Time-120),3*(Time-120),3*(Time-120)

[State 0, velset]
type = VelSet
trigger1 = time=120
X = -1

[State 2260, destroy]
type = RemoveExplod
trigger1 = time = 200

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 200

;------------------------------------------------
; Diagonal white foreground Chou Kamehameha fatality
[Statedef 5945]
type    = S
movetype= I
physics = N
anim = 5944
sprpriority = 8

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, rotate]
type = AngleDraw
trigger1 = 1
value = 150  ;180-angle

[State 2260, destroy]
type = DestroySelf
trigger1 = !animtime

;==============================================================
;MOVIE 7 INVISIBLE HITTING HELPER
[Statedef 2961]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = -3

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno && !movecontact
value = 2961

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = 0
y = 0

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;500,500
damage    = ceil(IfElse(root,fvar(11) * 500 < 7, 7, root,fvar(11) * 500)), 500
getpower = 0,0
givepower = 35,35
pausetime = 5,6
animtype = Hard
ground.type = low
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity = 0, -3
guard.velocity = -9
air.velocity = 0, -2
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
sparkno = -1
;hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
kill=(var(2)>=1)

[State 3025, p2state - killed]
type = targetstate
trigger1 = movehit && numtarget
trigger1 = target,gethitvar(hitcount)>=8
;trigger1 = MatchOver
;trigger1 = WinKO
value = ifelse((target, SelfAnimExist(5941)), 5941, 5943)
ignorehitpause = 1

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<2,2961,1316)

[State 1061, End]
type = destroyself
trigger1 = root,stateno != 2965


;===================================================
; KAIOKEN CHOU KAMEHAMEHA HELPER
[Statedef 3006]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State -2, Explod];var for scaling CLSNs
type = VarSet
trigger1 = !prevstateno && !time
var(1) = 0
[State -2, Explod];var for scaling CLSNs
type = VarAdd
trigger1 = !prevstateno
var(1) = 1

[State -2, Explod];Tip of Kmh FX
type = Explod
trigger1 = !numexplod(2404) && !time
anim = 2404
removetime = -1
sprpriority = 5
id = 2404
ownpal = 1
pos = 10,0
ignorehitpause = 1
bindtime = -1
scale = 1,1

[State -2, Explod];On hands explod
type = ModifyExplod
trigger1 = WinKO && MatchOver
scale = 1.5,1.5
ID = 2404

[State -2, Explod];Tip of Kmh FX
type = RemoveExplod
trigger1 = root,stateno != 3005
id = 2404

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(25) = root,var(25)

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno && !movecontact
value = 2405

[State 3005, anim]
type = changeanim
trigger1 = movecontact
value = 2405
elem = var(1)
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = ifelse((time<2 && var(2)>1),1,16)

[State 2011, NotHitBy]
type		= NotHitBy
trigger1		= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2011, HitBy]
type		= HitBy
trigger1		= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2011, HitOverride]
type		= HitOverride
trigger1		= Time >= 0
slot		= 1
Time		= 1
stateno		= 3006
attr		= SCA, NP, SP, HP
ignorehitpause	= 1

[State 3005, hit]
type = hitdef
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ifelse(var(2)>=30,13,ceil(30*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=30,13,ifElse(root,fvar(11) * 30 < 7, 7, root,fvar(11) * 30))),3
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<20+var(25), -2, -10), ifelse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 1315, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=7030
sprpriority=6
postype=p2
pos=(target,const(size.ground.front)-10)+(random%20), -floor(p2dist y)+(random%20)-10
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
pausemovetime=100
supermovetime=100

[State 3025, p2state - killed]
type = targetstate
trigger1 = movehit && numtarget
trigger1 = MatchOver
trigger1 = WinKO
value = ifelse((target, SelfAnimExist(5941)), 5941, 5943)
ignorehitpause = 1

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<30+var(25),3006,1316)

[State 1061, End]
type = destroyself
trigger1 = root,stateno != 3005

;===================================================
; KAIOKEN CHOU KAMEHAMEHA HELPER UP
[Statedef 3016]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, NoJuggle]
type = parentvarset
trigger1 = time = 0
v = 18
value = 1

[State -2, Explod];var for scaling CLSNs
type = VarSet
trigger1 = !prevstateno && !time
var(1) = 0
[State -2, Explod];var for scaling CLSNs
type = VarAdd
trigger1 = !prevstateno
var(1) = 1

[State 3000, Kamehameha FX beam]
type = helper
trigger1 = !numhelper(2465) && !time
helpertype = normal
stateno = 2465
ID = 2465
name = "tip-chouKmh"
postype = p1
pos = 0,0
ownpal = 1

[State 2011, NotHitBy]
type		= NotHitBy
trigger1		= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2011, HitBy]
type		= HitBy
trigger1		= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2011, HitOverride]
type		= HitOverride
trigger1		= Time >= 0
slot		= 1
Time		= 1
stateno		= 3016
attr		= SCA, NP, SP, HP
ignorehitpause	= 1

[State -2, Explod];Tip of Kmh FX
type = RemoveExplod
trigger1 = root,stateno != 3015
id = 2404

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(25) = root,var(25)

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=noshadow
ignorehitpause = 1

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno && !movecontact
value = 2465

[State 3005, anim]
type = changeanim
trigger1 = movecontact && animelemtime(30)<0
value = 2465
elem = var(1)
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = time<45
x = ifelse((time<2 && var(2)>1),1,10)
y = ifelse((time<2 && var(2)>1),-1,-7)

[State 1061, Velocity]
type = VelSet
trigger1 = time>=45
x = 0
y = 0

[State 3005, hit];Not MAX and not last hit
type = hitdef
triggerall = var(25)<20 && var(2)<30+var(25)
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ifelse(var(2)>=30,13,ceil(30*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=30,13,ifElse(root,fvar(11) * 30 < 7, 7, root,fvar(11) * 30))),3
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<30+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -1,-1
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 3005, hit];Not MAX and LAST hit
type = hitdef
triggerall = var(25)<20 && var(2)=30+var(25)
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ifelse(var(2)>=30,13,ceil(30*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=30,13,ifElse(root,fvar(11) * 30 < 7, 7, root,fvar(11) * 30))),3
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<30+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -6,-8
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
;p2stateno = 2467
id = 2467

[State 3005, hit];MAX and not last hit
type = hitdef
triggerall = var(25)>=20 && var(2)<30+var(25)
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ifelse(var(2)>=30,13,ceil(30*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=30,13,ifElse(root,fvar(11) * 30 < 7, 7, root,fvar(11) * 30))),3
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<30+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -1,-1
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5

[State 3005, hit];MAX and LAST hit
type = hitdef
triggerall = var(25)>=20 && var(2)=30+var(25)
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;ifelse(var(2)>=30,13,ceil(30*root,fvar(15))), 2
damage    = ceil(ifElse(var(2)>=30,13,ifElse(root,fvar(11) * 30 < 7, 7, root,fvar(11) * 30))),5
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<30+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= -6,-8
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = -1
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
p2stateno = 2467
id = 2467

[State 0, TargetState]  
type = TargetState
trigger1 = Numtarget(2467)
trigger1 = movehit = 1
value = 2467
ID = 2467
ignorehitpause = 1
persistent = 0

[State 1061, NoJuggle]
type = parentvarset
trigger1 = movecontact 
v = 18
value = 0

[State 1315, Sparks]
type=explod
trigger1= movehit && numtarget
trigger1= (target,movetype=H) && !(target,time)
anim=7030
sprpriority=6
postype=p2
pos=(target,const(size.ground.front)-10)+(random%20), (random%20)+(target,const(size.mid.pos.y))
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
pausemovetime=100
supermovetime=100

[State 3025, p2state - killed]
type = targetstate
trigger1 = movehit && numtarget
trigger1 = MatchOver
trigger1 = WinKO
value = 5944
ignorehitpause = 1

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<30+var(25),3016,3017)

[State 1061, End]
type = destroyself
trigger1 = root,stateno != 3015

;-----------------------------------------
; Kamehameha explod/vanish
[Statedef 3017]
type=A
physics=N
movetype=I
velset=0,0
ctrl=0
sprpriority=4

[State 1308, nothitby]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 3005, anim];VS Goku
type = changeanim
trigger1 = !time && var(11)=1
value = 1013
[State 3005, anim];Repel (purple)
type = changeanim
trigger1 = !time && var(11)=0 && prevstateno=1315 && root,var(44)>=1
value = 1316
[State 3005, anim];Repel (yellow/blue)
type = changeanim
trigger1 = !time && var(11)=0 && prevstateno=1315 && root,var(44)=0
value = 1311

[State 3005, anim];Chou Kmh
type = changeanim
trigger1 = !time && prevstateno=2402
trigger2 = !time && prevstateno=2462
trigger3 = !time && prevstateno=3006
value = 15998
[State 3005, anim];Genkidama
type = changeanim
trigger1 = !time && (prevstateno=2511 || prevstateno=2521 || prevstateno=2523 || prevstateno=2531 || prevstateno=2533)
value = 2511
[State 3005, anim];Genkidama
type = changeanim
trigger1 = prevstateno=2533
trigger1 = anim=2511 && !animtime
value = 2532

[State 1061, scale Genkidama]
type = AngleDraw
trigger1 = anim=2511
scale = 0.5-0.005*time,0.5-0.005*time
ignorehitpause = 1

[State 3005, anim];Movie 7 hitter
type = changeanim
trigger1 = !time && prevstateno=2961
value = 15997

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = root,var(2)=0
trans = none
ignorehitpause = 1

[State 1316, End]
type=destroyself
trigger1 = Time>=25

;====================================
; Broken Back - BG Arms + legs
[Statedef 245947]
type = S
movetype = H
physics = N
velset = 0,0
anim = 5947

[State 2260, bind]
type = bindtoroot
trigger1 = !ishelper
trigger1 = 1
pos = 0,0

[State 2260, bind]
type = bindtoparent
trigger1 = IsHelper
trigger1 = 1
pos = 0,0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 126

;====================================
; RE Broken Back - BG Arms + legs
[Statedef 355947]
type = S
movetype = H
physics = N
velset = 0,0
anim = 5947

[State 2260, bind]
type = bindtoroot
trigger1 = !ishelper
trigger1 = 1
pos = 0,0

[State 2260, bind]
type = bindtoparent
trigger1 = IsHelper
trigger1 = 1
pos = 0,0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, destroy]
type = DestroySelf
trigger1 = time = 19

;==========================================================
; Dragon Ball - Rolling from opponent
[Statedef 18045]
physics = N
velset = 0, 0
anim = 18045 + (random%7)
sprpriority = -5

[State 3033, Pos]
type = posadd
trigger1 = !time && numenemy
x = enemy, p2dist X - 20
y = -5

[State 3033, scale]
type = angledraw
trigger1 = 1
scale = 1,1

[State 4302, scale]
type = angleadd
trigger1 = vel x < 0
value = -5*(vel X)

[State 3033, Vel]
type = velset
trigger1 = time = [0,40]
x = -2

[State 3033, Vel]
type = veladd
trigger1 = time>40 && (vel x <0)
x = 0.3

[State 3033, Vel]
type = velset
trigger1 = time>40 && (vel x >0)
x = 0
